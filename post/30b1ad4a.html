<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>员工管理 | 满天鑫</title><meta name="keywords" content="前端,sass中台管理项目"><meta name="author" content="满天鑫"><meta name="copyright" content="满天鑫"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="封装一个通用的工具栏**目标**：封装一个通用的工具栏供大家使用 通用工具栏的组件结构 在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装   组件 src&#x2F;components&#x2F;PageTools&#x2F;index.vue &lt;template&gt;  &lt;el-card class&#x3D;&quot;page-tools&quot;&gt;    &lt;el-row">
<meta property="og:type" content="article">
<meta property="og:title" content="员工管理">
<meta property="og:url" content="https://smanman.github.io/post/30b1ad4a.html">
<meta property="og:site_name" content="满天鑫">
<meta property="og:description" content="封装一个通用的工具栏**目标**：封装一个通用的工具栏供大家使用 通用工具栏的组件结构 在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装   组件 src&#x2F;components&#x2F;PageTools&#x2F;index.vue &lt;template&gt;  &lt;el-card class&#x3D;&quot;page-tools&quot;&gt;    &lt;el-row">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212104.jpg">
<meta property="article:published_time" content="2021-11-19T14:39:00.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:29.391Z">
<meta property="article:author" content="满天鑫">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="sass中台管理项目">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212104.jpg"><link rel="shortcut icon" href="https://lvxueyangboke.oss-cn-beijing.aliyuncs.com/images/20210805191028.png"><link rel="canonical" href="https://smanman.github.io/post/30b1ad4a"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '员工管理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/ali_icon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mogai.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="满天鑫" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202406071141762.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">99</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212104.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">满天鑫</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/timeline/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">员工管理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-19T14:39:00.000Z" title="发表于 2021-11-19 22:39:00">2021-11-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:29.391Z" title="更新于 2022-11-27 17:16:29">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/sass%E4%B8%AD%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE/">sass中台管理项目</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">21.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>105分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="员工管理"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="封装一个通用的工具栏"><a href="#封装一个通用的工具栏" class="headerlink" title="封装一个通用的工具栏"></a>封装一个通用的工具栏</h2><p>**<code>目标</code>**：封装一个通用的工具栏供大家使用</p>
<h3 id="通用工具栏的组件结构"><a href="#通用工具栏的组件结构" class="headerlink" title="通用工具栏的组件结构"></a>通用工具栏的组件结构</h3><blockquote>
<p>在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145947.png" alt="image-20200723223704401"></p>
<p>组件 <strong><code>src/components/PageTools/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-card class=&quot;page-tools&quot;&gt;</span><br><span class="line">    &lt;el-row type=&quot;flex&quot; justify=&quot;space-between&quot; align=&quot;middle&quot;&gt;</span><br><span class="line">      &lt;el-col&gt;</span><br><span class="line">        &lt;div  v-if=&quot;showBefore&quot; class=&quot;before&quot;&gt;</span><br><span class="line">          &lt;i class=&quot;el-icon-info&quot; /&gt;</span><br><span class="line">          &lt;!-- 定义前面得插槽 --&gt;</span><br><span class="line">          &lt;slot name=&quot;before&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">      &lt;el-col&gt;</span><br><span class="line">        &lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;</span><br><span class="line">           &lt;!-- 定义后面的插槽 --&gt;</span><br><span class="line">           &lt;slot name=&quot;after&quot; /&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">  &lt;/el-card&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    showBefore: &#123;</span><br><span class="line">      type: Boolean,</span><br><span class="line">      default: false</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&#x27;scss&#x27;&gt;</span><br><span class="line"> .page-tools &#123;</span><br><span class="line">    margin: 10px 0;</span><br><span class="line">    .before &#123;</span><br><span class="line">      line-height: 34px;</span><br><span class="line">    i &#123;</span><br><span class="line">      margin-right: 5px;</span><br><span class="line">      color: #409eff;</span><br><span class="line">    &#125;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    padding: 0px 10px;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    border: 1px solid rgba(145, 213, 255, 1);</span><br><span class="line">    background: rgba(230, 247, 255, 1);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="组件统一注册"><a href="#组件统一注册" class="headerlink" title="组件统一注册"></a>组件统一注册</h3><blockquote>
<p>为了方便所有的页面都可以不用引用该组件，可以进行全局注册</p>
</blockquote>
<p>提供注册入口 <strong><code>src/componets/index.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 该文件负责所有的公共的组件的全局注册   Vue.use</span></span><br><span class="line"><span class="keyword">import</span> PageTools <span class="keyword">from</span> <span class="string">&#x27;./PageTools&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">install</span>(<span class="params">Vue</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//  注册全局的通用栏组件对象</span></span><br><span class="line">    Vue.component(<span class="string">&#x27;PageTools&#x27;</span>, PageTools)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在入口处进行注册 <strong><code>src/main.js</code></strong></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Component <span class="keyword">from</span> <span class="string">&#x27;@/components&#x27;</span></span><br><span class="line">Vue.use(Component) <span class="comment">// 注册自己的插件</span></span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**： 封装一个通用的工具栏</p>
<h2 id="员工列表页面的基本布局和结构"><a href="#员工列表页面的基本布局和结构" class="headerlink" title="员工列表页面的基本布局和结构"></a>员工列表页面的基本布局和结构</h2><p>**<code>目标</code>**：实现员工列表页面的基本布局和结构</p>
<p><strong>结构代码</strong> <strong><code>src/employees/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;dashboard-container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;app-container&quot;&gt;</span><br><span class="line">      &lt;page-tools :show-before=&quot;true&quot;&gt;</span><br><span class="line">        &lt;span slot=&quot;before&quot;&gt;共166条记录&lt;/span&gt;</span><br><span class="line">        &lt;template slot=&quot;after&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;small&quot; type=&quot;warning&quot;&gt;导入&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button size=&quot;small&quot; type=&quot;danger&quot;&gt;导出&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;新增员工&lt;/el-button&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/page-tools&gt;</span><br><span class="line">      &lt;!-- 放置表格和分页 --&gt;</span><br><span class="line">      &lt;el-card&gt;</span><br><span class="line">        &lt;el-table border&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;序号&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;姓名&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;工号&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;聘用形式&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;部门&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;账户状态&quot; sortable=&quot;&quot; /&gt;</span><br><span class="line">          &lt;el-table-column label=&quot;操作&quot; sortable=&quot;&quot; fixed=&quot;right&quot; width=&quot;280&quot;&gt;</span><br><span class="line">            &lt;template&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/el-table-column&gt;</span><br><span class="line">        &lt;/el-table&gt;</span><br><span class="line">        &lt;!-- 分页组件 --&gt;</span><br><span class="line">        &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot; align=&quot;middle&quot; style=&quot;height: 60px&quot;&gt;</span><br><span class="line">          &lt;el-pagination layout=&quot;prev, pager, next&quot; /&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">      &lt;/el-card&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145948.png" alt="image-20200831162222975"></p>
<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**：员工列表页面的基本布局和结构</p>
<h2 id="员工列表数据请求和分页加载"><a href="#员工列表数据请求和分页加载" class="headerlink" title="员工列表数据请求和分页加载"></a>员工列表数据请求和分页加载</h2><p>**<code>目标</code>**实现员工数据的加载和分页请求</p>
<p>首先，封装员工的加载请求 <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取员工的综合列表数据</span></span><br><span class="line"><span class="comment"> * ***/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getEmployeeList</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/sys/user&#x27;</span>,</span><br><span class="line">    params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后，实现加载数据和分页的逻辑</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getEmployeeList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/employees&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">list</span>: [], <span class="comment">// 接数据的</span></span><br><span class="line">      <span class="attr">page</span>: &#123;</span><br><span class="line">        <span class="attr">page</span>: <span class="number">1</span>, <span class="comment">// 当前页码</span></span><br><span class="line">        <span class="attr">size</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">total</span>: <span class="number">0</span> <span class="comment">// 总数</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getEmployeeList()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="function"><span class="title">changePage</span>(<span class="params">newPage</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.page.page = newPage</span><br><span class="line">      <span class="built_in">this</span>.getEmployeeList()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getEmployeeList</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.loading = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">const</span> &#123; total, rows &#125; = <span class="keyword">await</span> getEmployeeList(<span class="built_in">this</span>.page)</span><br><span class="line">      <span class="built_in">this</span>.page.total = total</span><br><span class="line">      <span class="built_in">this</span>.list = rows</span><br><span class="line">      <span class="built_in">this</span>.loading = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>绑定表格</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-card v-loading=&quot;loading&quot;&gt;</span><br><span class="line">  &lt;el-table border :data=&quot;list&quot;&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;序号&quot; sortable=&quot;&quot; type=&quot;index&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;姓名&quot; sortable=&quot;&quot; prop=&quot;username&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;工号&quot; sortable=&quot;&quot; prop=&quot;workNumber&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;聘用形式&quot; sortable=&quot;&quot; prop=&quot;formOfEmployment&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;部门&quot; sortable=&quot;&quot; prop=&quot;departmentName&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; prop=&quot;timeOfEntry&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;账户状态&quot; sortable=&quot;&quot; prop=&quot;enableState&quot; /&gt;</span><br><span class="line">    &lt;el-table-column label=&quot;操作&quot; sortable=&quot;&quot; fixed=&quot;right&quot; width=&quot;280&quot;&gt;</span><br><span class="line">      &lt;template&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line">  &lt;/el-table&gt;</span><br><span class="line">  &lt;!-- 分页组件 --&gt;</span><br><span class="line">  &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot; align=&quot;middle&quot; style=&quot;height: 60px&quot;&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      layout=&quot;prev, pager, next&quot;</span><br><span class="line">      :page-size=&quot;page.size&quot;</span><br><span class="line">      :current-page=&quot;page.page&quot;</span><br><span class="line">      :total=&quot;page.total&quot;</span><br><span class="line">      @current-change=&quot;changePage&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/el-row&gt;</span><br><span class="line">&lt;/el-card&gt;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**员工列表数据请求和分页加载</p>
<h2 id="员工列表中的数据进行格式化"><a href="#员工列表中的数据进行格式化" class="headerlink" title="员工列表中的数据进行格式化"></a>员工列表中的数据进行格式化</h2><p>**<code>目标</code>**：将列表中的内容进行格式化</p>
<h3 id="利用列格式化属性处理聘用形式"><a href="#利用列格式化属性处理聘用形式" class="headerlink" title="利用列格式化属性处理聘用形式"></a>利用列格式化属性处理聘用形式</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145949.png" alt="image-20200724001315166"></p>
<blockquote>
<p>上小节中，列表中的<strong>聘用形式</strong>/<strong>入职时间</strong>和<strong>账户状态</strong>需要进行显示内容的处理</p>
</blockquote>
<p>那么聘用形式中<strong>1</strong>代表什么含义，这实际上是我们需要的枚举数据，该数据的存放文件位于我们提供的**<code>资源/枚举</code><strong>中，可以将枚举下的文件夹放于</strong><code>src/api</code>**文件夹下</p>
<p>针对<strong>聘用形式</strong>，可以使用<strong>el-table-column</strong>的<strong>formatter</strong>属性进行设置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">import</span>    EmployeeEnum <span class="keyword">from</span> <span class="string">&#x27;@/api/constant/employees&#x27;</span></span><br><span class="line">&lt;!-- 格式化聘用形式 --&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;聘用形式&quot;</span> <span class="attr">sortable</span> <span class="attr">:formatter</span>=<span class="string">&quot;formatEmployment&quot;</span> /&gt;</span></span></span><br><span class="line">  <span class="comment">// 格式化聘用形式</span></span><br><span class="line">   <span class="function"><span class="title">formatEmployment</span>(<span class="params">row, column, cellValue, index</span>)</span> &#123;</span><br><span class="line">     <span class="comment">// 要去找 1所对应的值</span></span><br><span class="line">     <span class="keyword">const</span> obj = EmployeeEnum.hireType.find(<span class="function"><span class="params">item</span> =&gt;</span> item.id === cellValue)</span><br><span class="line">     <span class="keyword">return</span> obj ? obj.value : <span class="string">&#x27;未知&#x27;</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="过滤器解决时间格式的处理"><a href="#过滤器解决时间格式的处理" class="headerlink" title="过滤器解决时间格式的处理"></a>过滤器解决时间格式的处理</h3><p>针对入职时间，我们可以采用<strong>作用域插槽</strong>进行处理</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-table-column label=&quot;入职时间&quot; sortable prop=&quot;timeOfEntry&quot;&gt;</span><br><span class="line">           &lt;template slot-scope=&quot;obj&quot;&gt;</span><br><span class="line">             &#123;&#123;</span><br><span class="line">               obj.row.timeOfEntry | 过滤器</span><br><span class="line">             &#125;&#125;</span><br><span class="line">           &lt;/template&gt;</span><br><span class="line"> &lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>问题来了，过滤器从哪里呢？</p>
</blockquote>
<p>在**<code>资源/过滤器</code><strong>中，我们提供了若干工具方法，我们可以将其转化成过滤器，首先将其拷贝到</strong><code>src</code>**</p>
<p>在**<code>main.js</code>**中将工具方法转化成过滤器</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> filters <span class="keyword">from</span> <span class="string">&#x27;@/filters&#x27;</span> <span class="comment">// 引入工具类</span></span><br><span class="line"><span class="comment">// 注册全局的过滤器</span></span><br><span class="line"><span class="built_in">Object</span>.keys(filters).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 注册过滤器</span></span><br><span class="line">  Vue.filter(key, filters[key])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>好了，现在可以愉快的用过滤器的方式使用工具类的方法了</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; align=&quot;center&quot;&gt;</span><br><span class="line">     &lt;!-- 作用域插槽 --&gt;</span><br><span class="line">     &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;&#123;&#123; row.timeOfEntry | formatDate &#125;&#125;&lt;/template&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure>

<p>最后一项，账户状态，可以用开关组件switch进行显示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-table-column label=&quot;账户状态&quot; align=&quot;center&quot; sortable=&quot;&quot; prop=&quot;enableState&quot;&gt;</span><br><span class="line">           &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">             &lt;!-- 根据当前状态来确定 是否打开开关 --&gt;</span><br><span class="line">             &lt;el-switch :value=&quot;row.enableState === 1&quot; /&gt;</span><br><span class="line">           &lt;/template&gt;</span><br><span class="line">   &lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 员工列表中的数据进行格式化</p>
<h2 id="删除员工功能"><a href="#删除员工功能" class="headerlink" title="删除员工功能"></a>删除员工功能</h2><p>**<code>目标</code>**实现删除员工的功能</p>
<p>首先封装 删除员工的请求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除员工接口</span></span><br><span class="line"><span class="comment"> * ****/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">delEmployee</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/sys/user/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>删除功能</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;</span><br><span class="line">              &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;deleteEmployee(row.id)&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">            &lt;/template&gt; </span><br><span class="line">    // 删除员工</span><br><span class="line">    async deleteEmployee(id) &#123;</span><br><span class="line">      try &#123;</span><br><span class="line">        await this.$confirm(&#x27;您确定删除该员工吗&#x27;)</span><br><span class="line">        await delEmployee(id)</span><br><span class="line">        this.getEmployeeList()</span><br><span class="line">        this.$message.success(&#x27;删</span><br><span class="line">除员工成功&#x27;)</span><br><span class="line">      &#125; catch (error) &#123;</span><br><span class="line">        console.log(error)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**： 删除员工功能</p>
<h2 id="新增员工功能-弹层-校验-部门"><a href="#新增员工功能-弹层-校验-部门" class="headerlink" title="新增员工功能-弹层-校验-部门"></a>新增员工功能-弹层-校验-部门</h2><p>**<code>目标</code>**：实现新增员工的功能</p>
<h3 id="新建员工弹层组件"><a href="#新建员工弹层组件" class="headerlink" title="新建员工弹层组件"></a>新建员工弹层组件</h3><blockquote>
<p>当我们点击新增员工时，我们需要一个类似的弹层</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145950.png" alt="image-20200917110516195"></p>
<p>类似**<code>组织架构</code>**的组件，同样新建一个弹层组件 <strong><code>src/views/employees/components/add-employee.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-dialog title=&quot;新增员工&quot; :visible=&quot;showDialog&quot;&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;el-form label-width=&quot;120px&quot;&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;姓名&quot;&gt;</span><br><span class="line">        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入姓名&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;手机&quot;&gt;</span><br><span class="line">        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入手机号&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;入职时间&quot;&gt;</span><br><span class="line">        &lt;el-date-picker style=&quot;width:50%&quot; placeholder=&quot;请选择入职时间&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;聘用形式&quot;&gt;</span><br><span class="line">        &lt;el-select style=&quot;width:50%&quot; placeholder=&quot;请选择&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;工号&quot;&gt;</span><br><span class="line">        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入工号&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;部门&quot;&gt;</span><br><span class="line">        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;转正时间&quot;&gt;</span><br><span class="line">        &lt;el-date-picker style=&quot;width:50%&quot; placeholder=&quot;请选择转正时间&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">    &lt;!-- footer插槽 --&gt;</span><br><span class="line">    &lt;template v-slot:footer&gt;</span><br><span class="line">      &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;6&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;small&quot;&gt;取消&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot;&gt;确定&lt;/el-button&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/el-dialog&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    showDialog: &#123;</span><br><span class="line">      type: Boolean,</span><br><span class="line">      default: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="引用弹出层，点击弹出"><a href="#引用弹出层，点击弹出" class="headerlink" title="引用弹出层，点击弹出"></a>引用弹出层，点击弹出</h3><p>父组件中引用，弹出层</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import AddDemployee from &#x27;./components/add-employee&#x27;</span><br><span class="line">&lt;!-- 放置新增组件 --&gt;</span><br><span class="line"> &lt;add-employee :show-dialog.sync=&quot;showDialog&quot; /&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 放置新增组件 --&gt;</span><br><span class="line"> &lt;add-employee :show-dialog.sync=&quot;showDialog&quot; /&gt;</span><br><span class="line"></span><br><span class="line"> &lt;el-button icon=&quot;plus&quot; type=&quot;primary&quot; size=&quot;small&quot; @click=&quot;showDialog = true&quot;&gt;新增员工&lt;/el-button&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="新增员工的表单校验"><a href="#新增员工的表单校验" class="headerlink" title="新增员工的表单校验"></a>新增员工的表单校验</h3><p><strong>封装新增员工</strong>api <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** **</span></span><br><span class="line"><span class="comment"> *  新增员工的接口</span></span><br><span class="line"><span class="comment"> * **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addEmployee</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/sys/user&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>针对员工属性，添加校验规则</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EmployeeEnum <span class="keyword">from</span> <span class="string">&#x27;@/api/constant/employees&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      EmployeeEnum, <span class="comment">// 在data中定义数据</span></span><br><span class="line">      <span class="comment">// 表单数据</span></span><br><span class="line">      <span class="attr">treeData</span>: [], <span class="comment">// 定义数组接收树形数据</span></span><br><span class="line">      <span class="attr">showTree</span>: <span class="literal">false</span>, <span class="comment">// 控制树形的显示或者隐藏</span></span><br><span class="line">      <span class="attr">loading</span>: <span class="literal">false</span>, <span class="comment">// 控制树的显示或者隐藏进度条</span></span><br><span class="line">      <span class="attr">formData</span>: &#123;</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">mobile</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">formOfEmployment</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">workNumber</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">departmentName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">timeOfEntry</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">correctionTime</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="attr">username</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;用户姓名不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;, &#123;</span><br><span class="line">          <span class="attr">min</span>: <span class="number">1</span>, <span class="attr">max</span>: <span class="number">4</span>, <span class="attr">message</span>: <span class="string">&#x27;用户姓名为1-4位&#x27;</span></span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="attr">mobile</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;手机号不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;, &#123;</span><br><span class="line">          <span class="attr">pattern</span>: <span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>, message: <span class="string">&#x27;手机号格式不正确&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="attr">formOfEmployment</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;聘用形式不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;],</span><br><span class="line">        <span class="attr">workNumber</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;工号不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;],</span><br><span class="line">        <span class="attr">departmentName</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;部门不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;],</span><br><span class="line">        <span class="attr">timeOfEntry</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;入职时间&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>绑定数据和规则校验</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-form :model=&quot;formData&quot; :rules=&quot;rules&quot; label-width=&quot;120px&quot;&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;姓名&quot; prop=&quot;username&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;formData.username&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入姓名&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;手机&quot; prop=&quot;mobile&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;formData.mobile&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入手机号&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;入职时间&quot; prop=&quot;timeOfEntry&quot;&gt;</span><br><span class="line">    &lt;el-date-picker v-model=&quot;formData.timeOfEntry&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择日期&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;聘用形式&quot; prop=&quot;formOfEmployment&quot;&gt;</span><br><span class="line">    &lt;el-select v-model=&quot;formData.formOfEmployment&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;工号&quot; prop=&quot;workNumber&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;formData.workNumber&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入工号&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;部门&quot; prop=&quot;departmentName&quot;&gt;</span><br><span class="line">    &lt;el-input v-model=&quot;formData.departmentName&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">  &lt;el-form-item label=&quot;转正时间&quot; prop=&quot;correctionTime&quot;&gt;</span><br><span class="line">    &lt;el-date-picker v-model=&quot;formData.correctionTime&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择日期&quot; /&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br><span class="line">&lt;/el-form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="加载部门数据转化树形"><a href="#加载部门数据转化树形" class="headerlink" title="加载部门数据转化树形"></a>加载部门数据转化树形</h3><p><strong>聘用形式和选择部门的处理</strong></p>
<blockquote>
<p> 员工的部门是从树形部门中选择一个部门</p>
</blockquote>
<p><strong>获取部门数据，转化树形</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getDepartments &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/departments&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; transListToTreeData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils&#x27;</span></span><br><span class="line">  data () &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">             <span class="comment">// 表单数据</span></span><br><span class="line">       <span class="attr">treeData</span>: [], <span class="comment">// 定义数组接收树形数据</span></span><br><span class="line">       <span class="attr">showTree</span>: <span class="literal">false</span>, <span class="comment">// 控制树形的显示或者隐藏</span></span><br><span class="line">       <span class="attr">loading</span>: <span class="literal">false</span>, <span class="comment">// 控制树的显示或者隐藏进度条</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="keyword">async</span> <span class="function"><span class="title">getDepartments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.showTree = <span class="literal">true</span></span><br><span class="line">      <span class="built_in">this</span>.loading = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">const</span> &#123; depts &#125; = <span class="keyword">await</span> getDepartments()</span><br><span class="line">      <span class="comment">// depts是数组 但不是树形</span></span><br><span class="line">      <span class="built_in">this</span>.treeData = transListToTreeData(depts, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      <span class="built_in">this</span>.loading = <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="点击部门赋值表单数据"><a href="#点击部门赋值表单数据" class="headerlink" title="点击部门赋值表单数据"></a>点击部门赋值表单数据</h3><p><strong>选择部门，赋值表单数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;部门&quot; prop=&quot;departmentName&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;formData.departmentName&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; @focus=&quot;getDepartments&quot; /&gt;</span><br><span class="line">        &lt;!-- 放置一个tree组件 --&gt;</span><br><span class="line">        &lt;el-tree</span><br><span class="line">          v-if=&quot;showTree&quot;</span><br><span class="line">          v-loading=&quot;loading&quot;</span><br><span class="line">          :data=&quot;treeData&quot;</span><br><span class="line">          default-expand-all=&quot;&quot;</span><br><span class="line">          :props=&quot;&#123; label: &#x27;name&#x27; &#125;&quot;</span><br><span class="line">          @node-click=&quot;selectNode&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>



<p><strong>点击部门时触发</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">selectNode</span>(<span class="params">node</span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.formData.departmentName = node.name</span><br><span class="line">  <span class="built_in">this</span>.showTree = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>聘用形式</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;聘用形式&quot; prop=&quot;formOfEmployment&quot;&gt;</span><br><span class="line">    &lt;el-select v-model=&quot;formData.formOfEmployment&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">      &lt;!-- 遍历只能遍历组件的数据 --&gt;</span><br><span class="line">      &lt;el-option v-for=&quot;item in EmployeeEnum.hireType&quot; :key=&quot;item.id&quot; :label=&quot;item.value&quot; :value=&quot;item.id&quot; /&gt;</span><br><span class="line">    &lt;/el-select&gt;</span><br><span class="line">  &lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>



<h2 id="新增员工功能-确定-取消"><a href="#新增员工功能-确定-取消" class="headerlink" title="新增员工功能-确定-取消"></a>新增员工功能-确定-取消</h2><p><strong>调用新增接口</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 点击确定时 校验整个表单</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">btnOK</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">this</span>.$refs.addEmployee.validate()</span><br><span class="line">    <span class="comment">// 调用新增接口</span></span><br><span class="line">    <span class="keyword">await</span> addEmployee(<span class="built_in">this</span>.formData) <span class="comment">// 新增员工</span></span><br><span class="line">    <span class="comment">// 告诉父组件更新数据</span></span><br><span class="line">    <span class="comment">// this.$parent 可以直接调用到父组件的实例 实际上就是父组件this</span></span><br><span class="line">    <span class="comment">// this.$emit</span></span><br><span class="line">    <span class="built_in">this</span>.$parent.getEmployeeList()</span><br><span class="line">    <span class="built_in">this</span>.$parent.showDialog = <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">btnCancel</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 重置原来的数据</span></span><br><span class="line">  <span class="built_in">this</span>.formData = &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">mobile</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">formOfEmployment</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">workNumber</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">departmentName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">timeOfEntry</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">correctionTime</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">this</span>.$refs.addEmployee.resetFields() <span class="comment">// 重置校验结果</span></span><br><span class="line">  <span class="built_in">this</span>.$emit(<span class="string">&#x27;update:showDialog&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>新增员工的功能和组织架构的功能极其类似，这里不做过多阐述</p>
</blockquote>
<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 新增员工功能和弹层</p>
<h2 id="员工导入组件封装"><a href="#员工导入组件封装" class="headerlink" title="员工导入组件封装"></a>员工导入组件封装</h2><p>**<code>目标</code>**：封装一个导入excel数据的文件</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145951.png" alt="image-20200726005308648"></p>
<p>首先封装一个类似的组件，首先需要注意的是，类似功能，vue-element-admin已经提供了，我们只需要改造即可 <a target="_blank" rel="noopener" href="https://github.com/PanJiaChen/vue-element-admin/blob/master/src/components/UploadExcel/index.vue">代码地址</a></p>
<blockquote>
<p>类似功能性的组件，我们只需要会使用和封装即可 </p>
</blockquote>
<p>excel导入功能需要使用npm包**<code>xlsx</code><strong>，所以需要安装</strong><code>xlsx</code>**插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm i xlsx</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将vue-element-admin提供的导入功能新建一个组件，位置： <strong><code>src/components/UploadExcel</code></strong></p>
</blockquote>
<p><strong>注册全局的导入excel组件</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PageTools <span class="keyword">from</span> <span class="string">&#x27;./PageTools&#x27;</span></span><br><span class="line"><span class="keyword">import</span> UploadExcel <span class="keyword">from</span> <span class="string">&#x27;./UploadExcel&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">install</span>(<span class="params">Vue</span>)</span> &#123;</span><br><span class="line">    Vue.component(<span class="string">&#x27;PageTools&#x27;</span>, PageTools) <span class="comment">// 注册工具栏组件</span></span><br><span class="line">    Vue.component(<span class="string">&#x27;UploadExcel&#x27;</span>, UploadExcel) <span class="comment">// 注册导入excel组件</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>修改样式和布局</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> &lt;div class=&quot;upload-excel&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;btn-upload&quot;&gt;</span><br><span class="line">      &lt;el-button :loading=&quot;loading&quot; size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;handleUpload&quot;&gt;</span><br><span class="line">        点击上传</span><br><span class="line">      &lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input ref=&quot;excel-upload-input&quot; class=&quot;excel-upload-input&quot; type=&quot;file&quot; accept=&quot;.xlsx, .xls&quot; @change=&quot;handleClick&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;drop&quot; @drop=&quot;handleDrop&quot; @dragover=&quot;handleDragover&quot; @dragenter=&quot;handleDragover&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-upload&quot; /&gt;</span><br><span class="line">      &lt;span&gt;将文件拖到此处&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.upload-excel &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">   margin-top: 100px;</span><br><span class="line">   .excel-upload-input&#123;</span><br><span class="line">       display: none;</span><br><span class="line">        z-index: -9999;</span><br><span class="line">     &#125;</span><br><span class="line">   .btn-upload , .drop&#123;</span><br><span class="line">      border: 1px dashed #bbb;</span><br><span class="line">      width: 350px;</span><br><span class="line">      height: 160px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 160px;</span><br><span class="line">   &#125;</span><br><span class="line">   .drop&#123;</span><br><span class="line">       line-height: 80px;</span><br><span class="line">       color: #bbb;</span><br><span class="line">      i &#123;</span><br><span class="line">        font-size: 60px;</span><br><span class="line">        display: block;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**：员工导入组件封装</p>
<h2 id="员工的导入"><a href="#员工的导入" class="headerlink" title="员工的导入"></a>员工的导入</h2><p>**<code>目标</code>**：实现员工的导入</p>
<h3 id="建立公共导入的页面路由"><a href="#建立公共导入的页面路由" class="headerlink" title="建立公共导入的页面路由"></a>建立公共导入的页面路由</h3><p><strong>新建一个公共的导入页面，挂载路由</strong> <strong><code>src/router/index.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/import&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Layout,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// 隐藏在左侧菜单中</span></span><br><span class="line">    <span class="attr">children</span>: [&#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 二级路由path什么都不写 表示二级默认路由</span></span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/import&#x27;</span>)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>创建import路由组件</strong> <strong><code>src/views/import/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 公共导入组件 --&gt; </span><br><span class="line">  &lt;upload-excel :on-success=&quot;success&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="分析excel导入代码，封装接口"><a href="#分析excel导入代码，封装接口" class="headerlink" title="分析excel导入代码，封装接口"></a>分析excel导入代码，封装接口</h3><blockquote>
<p>封装导入员工的api接口  </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *  封装一个导入员工的接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ***/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">importEmployee</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/sys/user/batch&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="实现excel导入"><a href="#实现excel导入" class="headerlink" title="实现excel导入"></a>实现excel导入</h3><p><strong>获取导入的excel数据, 导入excel接口</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>  <span class="function"><span class="title">success</span>(<span class="params">&#123; header, results &#125;</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 如果是导入员工</span></span><br><span class="line">    <span class="keyword">const</span> userRelations = &#123;</span><br><span class="line">      <span class="string">&#x27;入职日期&#x27;</span>: <span class="string">&#x27;timeOfEntry&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;手机号&#x27;</span>: <span class="string">&#x27;mobile&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;转正日期&#x27;</span>: <span class="string">&#x27;correctionTime&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;workNumber&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> arr = []</span><br><span class="line">   results.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> userInfo = &#123;&#125;</span><br><span class="line">      <span class="built_in">Object</span>.keys(item).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        userInfo[userRelations[key]] = item[key]</span><br><span class="line">      &#125;)</span><br><span class="line">     arr.push(userInfo) </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">await</span> importEmployee(arr) <span class="comment">// 调用导入接口</span></span><br><span class="line">    <span class="built_in">this</span>.$router.back()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>为了让这个页面可以服务更多的导入功能，我们可以在页面中用参数来判断，是否是导入员工</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> &#123;</span><br><span class="line">     <span class="attr">type</span>: <span class="built_in">this</span>.$route.query.type</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<p>当excel中有日期格式的时候，实际转化的值为一个数字，我们需要一个方法进行转化</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">formatDate</span>(<span class="params">numb, format</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>((numb - <span class="number">1</span>) * <span class="number">24</span> * <span class="number">3600000</span> + <span class="number">1</span>)</span><br><span class="line">  time.setYear(time.getFullYear() - <span class="number">70</span>)</span><br><span class="line">  <span class="keyword">const</span> year = time.getFullYear() + <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> month = time.getMonth() + <span class="number">1</span> + <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> date = time.getDate() - <span class="number">1</span> + <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (format &amp;&amp; format.length === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> year + format + month + format + date</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> year + (month &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + month : month) + (date &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + date : date)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要注意，**<code>导入的手机号不能和之前的存在的手机号重复</code>**</p>
</blockquote>
<p><strong>逻辑判断</strong> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>  <span class="function"><span class="title">success</span>(<span class="params">&#123; header, results &#125;</span>)</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="built_in">this</span>.type === <span class="string">&#x27;user&#x27;</span>) &#123;</span><br><span class="line">       <span class="keyword">const</span> userRelations = &#123;</span><br><span class="line">         <span class="string">&#x27;入职日期&#x27;</span>: <span class="string">&#x27;timeOfEntry&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;手机号&#x27;</span>: <span class="string">&#x27;mobile&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;转正日期&#x27;</span>: <span class="string">&#x27;correctionTime&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;workNumber&#x27;</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">const</span> arr = []</span><br><span class="line">       <span class="comment">// 遍历所有的数组</span></span><br><span class="line">       results.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">// 需要将每一个条数据里面的中文都换成英文</span></span><br><span class="line">         <span class="keyword">const</span> userInfo = &#123;&#125;</span><br><span class="line">         <span class="built_in">Object</span>.keys(item).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">         <span class="comment">// key是当前的中文名 找到对应的英文名</span></span><br><span class="line">           <span class="keyword">if</span> (userRelations[key] === <span class="string">&#x27;timeOfEntry&#x27;</span> || userRelations[key] === <span class="string">&#x27;correctionTime&#x27;</span>) &#123;</span><br><span class="line">             userInfo[userRelations[key]] = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">this</span>.formatDate(item[key], <span class="string">&#x27;/&#x27;</span>)) <span class="comment">// 只有这样, 才能入库</span></span><br><span class="line">             <span class="keyword">return</span></span><br><span class="line">           &#125;</span><br><span class="line">           userInfo[userRelations[key]] = item[key]</span><br><span class="line">         &#125;)</span><br><span class="line">         <span class="comment">// 最终userInfo变成了全是英文</span></span><br><span class="line">         arr.push(userInfo)</span><br><span class="line">       &#125;)</span><br><span class="line">       <span class="keyword">await</span> importEmployee(arr)</span><br><span class="line">       <span class="built_in">this</span>.$message.success(<span class="string">&#x27;导入成功&#x27;</span>)</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="built_in">this</span>.$router.back() <span class="comment">// 回到上一页</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="function"><span class="title">formatDate</span>(<span class="params">numb, format</span>)</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>((numb - <span class="number">1</span>) * <span class="number">24</span> * <span class="number">3600000</span> + <span class="number">1</span>)</span><br><span class="line">     time.setYear(time.getFullYear() - <span class="number">70</span>)</span><br><span class="line">     <span class="keyword">const</span> year = time.getFullYear() + <span class="string">&#x27;&#x27;</span></span><br><span class="line">     <span class="keyword">const</span> month = time.getMonth() + <span class="number">1</span> + <span class="string">&#x27;&#x27;</span></span><br><span class="line">     <span class="keyword">const</span> date = time.getDate() - <span class="number">1</span> + <span class="string">&#x27;&#x27;</span></span><br><span class="line">     <span class="keyword">if</span> (format &amp;&amp; format.length === <span class="number">1</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> year + format + month + format + date</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> year + (month &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + month : month) + (date &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + date : date)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><strong>员工页面跳转</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-button type=&quot;warning&quot; size=&quot;small&quot; @click=&quot;$router.push(&#x27;/import?type=user&#x27;)&quot;&gt;导入&lt;/el-button&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>**<code>目标</code>**： 实现员工的导入</p>
<h2 id="员工导出excel功能"><a href="#员工导出excel功能" class="headerlink" title="员工导出excel功能"></a>员工导出excel功能</h2><p><strong>目标</strong>： 实现将员工数据导出功能</p>
<blockquote>
<p>日常业务中，我们经常遇到excel导出功能， 怎么使用呢</p>
</blockquote>
<p>Excel 的导入导出都是依赖于<a target="_blank" rel="noopener" href="https://github.com/SheetJS/js-xlsx">js-xlsx</a>来实现的。</p>
<p>在 <code>js-xlsx</code>的基础上又封装了<a target="_blank" rel="noopener" href="https://github.com/PanJiaChen/vue-element-admin/blob/master/src/vendor/Export2Excel.js">Export2Excel.js</a>来方便导出数据。</p>
<h3 id="安装excel所需依赖和按需加载"><a href="#安装excel所需依赖和按需加载" class="headerlink" title="安装excel所需依赖和按需加载"></a>安装excel所需依赖和按需加载</h3><p>由于 <code>Export2Excel</code>不仅依赖<code>js-xlsx</code>还依赖<code>file-saver</code>和<code>script-loader</code>。</p>
<p>所以你先需要安装如下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install xlsx file-saver -S</span><br><span class="line">npm install script-loader -S -D</span><br></pre></td></tr></table></figure>

<p>由于<code>js-xlsx</code>体积还是很大的，导出功能也不是一个非常常用的功能，所以使用的时候建议使用懒加载。使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).then(<span class="function"><span class="params">excel</span> =&gt;</span> &#123;</span><br><span class="line">  excel.export_json_to_excel(&#123;</span><br><span class="line">    <span class="attr">header</span>: tHeader, <span class="comment">//表头 必填</span></span><br><span class="line">    data, <span class="comment">//具体数据 必填</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;excel-list&#x27;</span>, <span class="comment">//非必填</span></span><br><span class="line">    <span class="attr">autoWidth</span>: <span class="literal">true</span>, <span class="comment">//非必填</span></span><br><span class="line">    <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span> <span class="comment">//非必填</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="excel导出参数的介绍"><a href="#excel导出参数的介绍" class="headerlink" title="excel导出参数的介绍"></a>excel导出参数的介绍</h3><blockquote>
<p>vue-element-admin提供了导出的功能模块，在课程资源/excel导出目录下，放置到src目录下</p>
</blockquote>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>header</td>
<td>导出数据的表头</td>
<td>Array</td>
<td>/</td>
<td>[]</td>
</tr>
<tr>
<td>data</td>
<td>导出的具体数据</td>
<td>Array</td>
<td>/</td>
<td>[[]]</td>
</tr>
<tr>
<td>filename</td>
<td>导出文件名</td>
<td>String</td>
<td>/</td>
<td>excel-list</td>
</tr>
<tr>
<td>autoWidth</td>
<td>单元格是否要自适应宽度</td>
<td>Boolean</td>
<td>true / false</td>
<td>true</td>
</tr>
<tr>
<td>bookType</td>
<td>导出文件类型</td>
<td>String</td>
<td>xlsx, csv, txt, <a target="_blank" rel="noopener" href="https://github.com/SheetJS/js-xlsx#supported-output-formats">more</a></td>
<td>xlsx</td>
</tr>
</tbody></table>
<h3 id="excel导出基本的结构"><a href="#excel导出基本的结构" class="headerlink" title="excel导出基本的结构"></a>excel导出基本的结构</h3><blockquote>
<p>我们最重要的一件事，就是把表头和数据进行相应的对应</p>
</blockquote>
<p>因为数据中的key是英文，想要导出的表头是中文的话，需要将中文和英文做对应</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> headers = &#123;</span><br><span class="line">     <span class="string">&#x27;手机号&#x27;</span>: <span class="string">&#x27;mobile&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;入职日期&#x27;</span>: <span class="string">&#x27;timeOfEntry&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;聘用形式&#x27;</span>: <span class="string">&#x27;formOfEmployment&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;转正日期&#x27;</span>: <span class="string">&#x27;correctionTime&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;workNumber&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;部门&#x27;</span>: <span class="string">&#x27;departmentName&#x27;</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>然后，<strong>完成导出代码</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导出excel数据</span></span><br><span class="line"><span class="function"><span class="title">exportData</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="comment">//  做操作</span></span><br><span class="line">  <span class="comment">// 表头对应关系</span></span><br><span class="line">  <span class="keyword">const</span> headers = &#123;</span><br><span class="line">    <span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;手机号&#x27;</span>: <span class="string">&#x27;mobile&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;入职日期&#x27;</span>: <span class="string">&#x27;timeOfEntry&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;聘用形式&#x27;</span>: <span class="string">&#x27;formOfEmployment&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;转正日期&#x27;</span>: <span class="string">&#x27;correctionTime&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;workNumber&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;部门&#x27;</span>: <span class="string">&#x27;departmentName&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 懒加载</span></span><br><span class="line">  <span class="keyword">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).then(<span class="keyword">async</span> excel =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; rows &#125; = <span class="keyword">await</span> getEmployeeList(&#123; <span class="attr">page</span>: <span class="number">1</span>, <span class="attr">size</span>: <span class="built_in">this</span>.page.total &#125;)</span><br><span class="line">    <span class="keyword">const</span> data = <span class="built_in">this</span>.formatJson(headers, rows)</span><br><span class="line"></span><br><span class="line">    excel.export_json_to_excel(&#123;</span><br><span class="line">      <span class="attr">header</span>: <span class="built_in">Object</span>.keys(headers),</span><br><span class="line">      data,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;员工信息表&#x27;</span>,</span><br><span class="line">      <span class="attr">autoWidth</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">bookType</span>: <span class="string">&#x27;xlsx&#x27;</span></span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 获取所有的数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// excel.export_json_to_excel(&#123;</span></span><br><span class="line">    <span class="comment">//   header: [&#x27;姓名&#x27;, &#x27;薪资&#x27;],</span></span><br><span class="line">    <span class="comment">//   data: [[&#x27;张三&#x27;, 12000], [&#x27;李四&#x27;, 5000]],</span></span><br><span class="line">    <span class="comment">//   filename: &#x27;员工薪资表&#x27;,</span></span><br><span class="line">    <span class="comment">//   autoWidth: true,</span></span><br><span class="line">    <span class="comment">//   bookType: &#x27;csv&#x27;</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 该方法负责将数组转化成二维数组</span></span><br><span class="line"><span class="function"><span class="title">formatJson</span>(<span class="params">headers, rows</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 首先遍历数组</span></span><br><span class="line">  <span class="comment">// [&#123; username: &#x27;张三&#x27;&#125;,&#123;&#125;,&#123;&#125;]  =&gt; [[’张三&#x27;],[],[]]</span></span><br><span class="line">  <span class="keyword">return</span> rows.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(headers).map(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="string">&#x27;correctionTime&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> formatDate(item[headers[key]]) <span class="comment">// 返回格式化之前的时间</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;formOfEmployment&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> en = EmployeeEnum.hireType.find(<span class="function"><span class="params">obj</span> =&gt;</span> obj.id === item[headers[key]])</span><br><span class="line">        <span class="keyword">return</span> en ? en.value : <span class="string">&#x27;未知&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> item[headers[key]]</span><br><span class="line">    &#125;) <span class="comment">// =&gt; [&quot;张三&quot;, &quot;13811&quot;，&quot;2018&quot;,&quot;1&quot;, &quot;2018&quot;, &quot;10002&quot;]</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// return data</span></span><br><span class="line">  <span class="comment">// return rows.map(item =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   // item是对象  =&gt; 转化成只有值的数组 =&gt; 数组值的顺序依赖headers  &#123;username: &#x27;张三&#x27;  &#125;</span></span><br><span class="line">  <span class="comment">//   // Object.keys(headers)  =&gt; [&quot;姓名&quot;, &quot;手机号&quot;,...]</span></span><br><span class="line">  <span class="comment">//   return Object.keys(headers).map(key =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     return item[headers[key]]</span></span><br><span class="line">  <span class="comment">//   &#125;) // /  得到 [&#x27;张三&#x27;，’129‘，’dd‘,&#x27;dd&#x27;]</span></span><br><span class="line">  <span class="comment">// &#125;)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="导出时间格式的处理"><a href="#导出时间格式的处理" class="headerlink" title="导出时间格式的处理"></a>导出时间格式的处理</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">formatJson</span>(<span class="params">headers, rows</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> rows.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// item是一个对象  &#123; mobile: 132111,username: &#x27;张三&#x27;  &#125;</span></span><br><span class="line">    <span class="comment">// [&quot;手机号&quot;, &quot;姓名&quot;, &quot;入职日期&quot; 。。]</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(headers).map(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 需要判断 字段</span></span><br><span class="line">      <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="string">&#x27;correctionTime&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 格式化日期</span></span><br><span class="line">        <span class="keyword">return</span> formatDate(item[headers[key]])</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;formOfEmployment&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> obj = EmployeeEnum.hireType.find(<span class="function"><span class="params">obj</span> =&gt;</span> obj.id === item[headers[key]])</span><br><span class="line">        <span class="keyword">return</span> obj ? obj.value : <span class="string">&#x27;未知&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> item[headers[key]]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// [&quot;132&quot;, &#x27;张三’， ‘’，‘’，‘’d]</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// return rows.map(item =&gt; Object.keys(headers).map(key =&gt; item[headers[key]]))</span></span><br><span class="line">  <span class="comment">// 需要处理时间格式问题</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="扩展-复杂表头的导出"><a href="#扩展-复杂表头的导出" class="headerlink" title="扩展  复杂表头的导出"></a><strong><code>扩展</code></strong>  复杂表头的导出</h3><blockquote>
<p>当需要导出复杂表头的时候，vue-element-admin同样支持该类操作</p>
</blockquote>
<p><strong>vue-element-admin</strong> 提供的导出方法中有 <strong>multiHeader</strong>和<strong>merges</strong> 的参数</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>multiHeader</td>
<td>复杂表头的部分</td>
<td>Array</td>
<td>/</td>
<td>[[]]</td>
</tr>
<tr>
<td>merges</td>
<td>需要合并的部分</td>
<td>Array</td>
<td>/</td>
<td>[]</td>
</tr>
</tbody></table>
<p>multiHeader里面是一个二维数组，里面的一个元素是一行表头，假设你想得到一个如图的结构</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145952.png" alt="image-20201014152302636"></p>
<p>mutiHeader应该这样定义</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> multiHeader = [[<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;主要信息&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;部门&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<p>multiHeader中的一行表头中的字段的个数需要和真正的列数相等，假设想要跨列，多余的空间需要定义成空串</p>
<p>它主要对应的是标准的表头</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> header = [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;手机号&#x27;</span>, <span class="string">&#x27;入职日期&#x27;</span>, <span class="string">&#x27;聘用形式&#x27;</span>, <span class="string">&#x27;转正日期&#x27;</span>, <span class="string">&#x27;工号&#x27;</span>, <span class="string">&#x27;部门&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>如果，我们要实现其合并的效果， 需要设定merges选项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> merges = [<span class="string">&#x27;A1:A2&#x27;</span>, <span class="string">&#x27;B1:F1&#x27;</span>, <span class="string">&#x27;G1:G2&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>merges的顺序是没关系的，只要配置这两个属性，就可以导出复杂表头的excel了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">exportData</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> headers = &#123;</span><br><span class="line">      <span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;手机号&#x27;</span>: <span class="string">&#x27;mobile&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;入职日期&#x27;</span>: <span class="string">&#x27;timeOfEntry&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;聘用形式&#x27;</span>: <span class="string">&#x27;formOfEmployment&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;转正日期&#x27;</span>: <span class="string">&#x27;correctionTime&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;workNumber&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;部门&#x27;</span>: <span class="string">&#x27;departmentName&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 导出excel</span></span><br><span class="line">    <span class="keyword">import</span>(<span class="string">&#x27;@/vendor/Export2Excel&#x27;</span>).then(<span class="keyword">async</span> excel =&gt; &#123;</span><br><span class="line">      <span class="comment">//  excel是引入文件的导出对象</span></span><br><span class="line">      <span class="comment">// 导出  header从哪里来</span></span><br><span class="line">      <span class="comment">// data从哪里来</span></span><br><span class="line">      <span class="comment">// 现在没有一个接口获取所有的数据</span></span><br><span class="line">      <span class="comment">// 获取员工的接口 页码 每页条数    100   1 10000</span></span><br><span class="line">      <span class="keyword">const</span> &#123; rows &#125; = <span class="keyword">await</span> getEmployeeList(&#123; <span class="attr">page</span>: <span class="number">1</span>, <span class="attr">size</span>: <span class="built_in">this</span>.page.total &#125;)</span><br><span class="line">      <span class="keyword">const</span> data = <span class="built_in">this</span>.formatJson(headers, rows) <span class="comment">// 返回的data就是 要导出的结构</span></span><br><span class="line">      <span class="keyword">const</span> multiHeader = [[<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;主要信息&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;部门&#x27;</span>]]</span><br><span class="line">      <span class="keyword">const</span> merges = [<span class="string">&#x27;A1:A2&#x27;</span>, <span class="string">&#x27;B1:F1&#x27;</span>, <span class="string">&#x27;G1:G2&#x27;</span>]</span><br><span class="line">      excel.export_json_to_excel(&#123;</span><br><span class="line">        <span class="attr">header</span>: <span class="built_in">Object</span>.keys(headers),</span><br><span class="line">        data,</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;员工资料表&#x27;</span>,</span><br><span class="line">        multiHeader, <span class="comment">// 复杂表头</span></span><br><span class="line">        merges <span class="comment">// 合并选项</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// excel.export_json_to_excel(&#123;</span></span><br><span class="line">      <span class="comment">//   header: [&#x27;姓名&#x27;, &#x27;工资&#x27;],</span></span><br><span class="line">      <span class="comment">//   data: [[&#x27;张三&#x27;, 3000], [&#x27;李四&#x27;, 5000]],</span></span><br><span class="line">      <span class="comment">//   filename: &#x27;员工工资表&#x27;</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">      <span class="comment">// [&#123; username: &#x27;张三&#x27;,mobile: 13112345678 &#125;]  =&gt; [[]]</span></span><br><span class="line">      <span class="comment">// 要转化 数据结构 还要和表头的顺序对应上</span></span><br><span class="line">      <span class="comment">// 要求转出的标题是中文</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 将表头数据和数据进行对应</span></span><br><span class="line">  <span class="comment">// [&#123;&#125;]  =&gt;   [[]]</span></span><br><span class="line">  <span class="function"><span class="title">formatJson</span>(<span class="params">headers, rows</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> rows.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// item是一个对象  &#123; mobile: 132111,username: &#x27;张三&#x27;  &#125;</span></span><br><span class="line">      <span class="comment">// [&quot;手机号&quot;, &quot;姓名&quot;, &quot;入职日期&quot; 。。]</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Object</span>.keys(headers).map(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 需要判断 字段</span></span><br><span class="line">        <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="string">&#x27;correctionTime&#x27;</span>) &#123;</span><br><span class="line">          <span class="comment">// 格式化日期</span></span><br><span class="line">          <span class="keyword">return</span> formatDate(item[headers[key]])</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (headers[key] === <span class="string">&#x27;formOfEmployment&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> obj = EmployeeEnum.hireType.find(<span class="function"><span class="params">obj</span> =&gt;</span> obj.id === item[headers[key]])</span><br><span class="line">          <span class="keyword">return</span> obj ? obj.value : <span class="string">&#x27;未知&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> item[headers[key]]</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="comment">// [&quot;132&quot;, &#x27;张三’， ‘’，‘’，‘’d]</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// return rows.map(item =&gt; Object.keys(headers).map(key =&gt; item[headers[key]]))</span></span><br><span class="line">    <span class="comment">// 需要处理时间格式问题</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**实现将员工数据导出功能</p>
<h2 id="员工详情页创建和布局"><a href="#员工详情页创建和布局" class="headerlink" title="员工详情页创建和布局"></a>员工详情页创建和布局</h2><p>**<code>目标</code>**：创建员工详情的主要布局页面和基本布局</p>
<h3 id="详情页的基本布局和路由"><a href="#详情页的基本布局和路由" class="headerlink" title="详情页的基本布局和路由"></a>详情页的基本布局和路由</h3><p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145953.png" alt="image-20200726130305221"></p>
<p><strong>建立详情页路由</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;detail/:id&#x27;</span>, <span class="comment">// query传参 动态路由传参</span></span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/employees/detail&#x27;</span>),</span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// 不在左侧菜单显示</span></span><br><span class="line">    <span class="attr">meta</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;员工详情&#x27;</span> <span class="comment">// 标记当前路由规则的中文名称 后续在做左侧菜单时 使用</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>建立基本架构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;dashboard-container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;app-container&quot;&gt;</span><br><span class="line">      &lt;el-card&gt;</span><br><span class="line">        &lt;el-tabs&gt;</span><br><span class="line">          &lt;el-tab-pane label=&quot;登录账户设置&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;!-- 放置表单 --&gt;</span><br><span class="line">            &lt;el-form label-width=&quot;120px&quot; style=&quot;margin-left: 120px; margin-top:30px&quot;&gt;</span><br><span class="line">              &lt;el-form-item label=&quot;姓名:&quot;&gt;</span><br><span class="line">                &lt;el-input style=&quot;width:300px&quot; /&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">              &lt;el-form-item label=&quot;密码:&quot;&gt;</span><br><span class="line">                &lt;el-input style=&quot;width:300px&quot; type=&quot;password&quot; /&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">              &lt;el-form-item&gt;</span><br><span class="line">                &lt;el-button type=&quot;primary&quot;&gt;更新&lt;/el-button&gt;</span><br><span class="line">              &lt;/el-form-item&gt;</span><br><span class="line">            &lt;/el-form&gt;</span><br><span class="line">          &lt;/el-tab-pane&gt;</span><br><span class="line">          &lt;el-tab-pane label=&quot;个人详情&quot; /&gt;</span><br><span class="line">          &lt;el-tab-pane label=&quot;岗位信息&quot; /&gt;</span><br><span class="line">        &lt;/el-tabs&gt;</span><br><span class="line">      &lt;/el-card&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><strong>列表跳转到详情</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;$router.push(`/employees/detail/$&#123;obj.row.id&#125;`)&quot;&gt;查看&lt;/el-button&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="读取和保存用户信息的接口"><a href="#读取和保存用户信息的接口" class="headerlink" title="读取和保存用户信息的接口"></a>读取和保存用户信息的接口</h3><p><strong>加载个人基本信息</strong> &gt; 该接口已经在之前提供过了 <strong><code>src/api/user.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *  获取某个用户的基本信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ***/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getUserDetailById</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/sys/user/<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>保存个人基本信息</strong>  <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 保存员工的基本信息</span></span><br><span class="line"><span class="comment"> * **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">saveUserDetailById</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/sys/user/<span class="subst">$&#123;data.id&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="实现用户名和密码的修改"><a href="#实现用户名和密码的修改" class="headerlink" title="实现用户名和密码的修改"></a>实现用户名和密码的修改</h3><p><strong><code>注意</code><strong>：这里有个缺陷，接口中读取的是后端的密文，我们并不能解密，所以当我们没有任何修改就保存时，会校验失败，因为密文超过了规定的12位长度，为了真的修改密码，我们设定了一个临时的字段 <strong>password2</strong>，用它来存储我们的修改值，最后保存的时候，把</strong>password2</strong>传给<strong>password</strong></p>
<p><strong>用户名和密码的修改</strong>  <strong><code>src/views/employees/detail.vue</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getUserDetailById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; saveUserDetailById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/employees&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userId</span>: <span class="built_in">this</span>.$route.params.id, <span class="comment">// 这样可以后面直接通过 this.userId进行获取数据</span></span><br><span class="line">      <span class="attr">userInfo</span>: &#123;</span><br><span class="line">        <span class="comment">//   专门存放基本信息</span></span><br><span class="line">        <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">password2</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="attr">username</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;姓名不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;],</span><br><span class="line">        <span class="attr">password2</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;密码不能为空&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">min</span>: <span class="number">6</span>, <span class="attr">max</span>: <span class="number">9</span>, <span class="attr">message</span>: <span class="string">&#x27;密码长度6-9位&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getUserDetailById()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getUserDetailById</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.userInfo = <span class="keyword">await</span> getUserDetailById(<span class="built_in">this</span>.userId)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">saveUser</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 校验</span></span><br><span class="line">        <span class="keyword">await</span> <span class="built_in">this</span>.$refs.userForm.validate()</span><br><span class="line">        <span class="keyword">await</span> saveUserDetailById(&#123; ...this.userInfo, <span class="attr">password</span>: <span class="built_in">this</span>.userInfo.password2 &#125;) <span class="comment">// 将新密码的值替换原密码的值</span></span><br><span class="line">        <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存成功&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>绑定表单数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 放置表单 --&gt;</span><br><span class="line">           &lt;el-form ref=&quot;userForm&quot; :model=&quot;userInfo&quot; :rules=&quot;rules&quot; label-width=&quot;120px&quot; style=&quot;margin-left: 120px; margin-top:30px&quot;&gt;</span><br><span class="line">             &lt;el-form-item label=&quot;姓名:&quot; prop=&quot;username&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;userInfo.username&quot; style=&quot;width:300px&quot; /&gt;</span><br><span class="line">             &lt;/el-form-item&gt;</span><br><span class="line">             &lt;el-form-item label=&quot;新密码:&quot; prop=&quot;password2&quot;&gt;</span><br><span class="line">               &lt;el-input v-model=&quot;userInfo.password2&quot; style=&quot;width:300px&quot; type=&quot;password&quot; /&gt;</span><br><span class="line">             &lt;/el-form-item&gt;</span><br><span class="line">             &lt;el-form-item&gt;</span><br><span class="line">               &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;更新&lt;/el-button&gt;</span><br><span class="line">             &lt;/el-form-item&gt;</span><br><span class="line">           &lt;/el-form&gt;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<h2 id="个人组件和岗位组件封装"><a href="#个人组件和岗位组件封装" class="headerlink" title="个人组件和岗位组件封装"></a>个人组件和岗位组件封装</h2><h3 id="封装个人详情组件"><a href="#封装个人详情组件" class="headerlink" title="封装个人详情组件"></a>封装个人详情组件</h3><blockquote>
<p>我们将员工个人信息分为三部分，账户，个人， 岗位，这个小节我们对个人组件和岗位组件进行封装</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145954.png" alt="image-20200901105323305"></p>
<p><strong>封装个人组件</strong>   <strong><code>src/views/employees/components/user-info.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;user-info&quot;&gt;</span><br><span class="line">    &lt;!-- 个人信息 --&gt;</span><br><span class="line">    &lt;el-form label-width=&quot;220px&quot;&gt;</span><br><span class="line">      &lt;!-- 工号 入职时间 --&gt;</span><br><span class="line">      &lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;工号&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;userInfo.workNumber&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;入职时间&quot;&gt;</span><br><span class="line">            &lt;el-date-picker</span><br><span class="line">              v-model=&quot;userInfo.timeOfEntry&quot;</span><br><span class="line">              type=&quot;date&quot;</span><br><span class="line">              class=&quot;inputW&quot;</span><br><span class="line">              value-format=&quot;YYYY-MM-DD&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">      &lt;!-- 姓名 部门 --&gt;</span><br><span class="line">      &lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;姓名&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;userInfo.username&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;部门&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;userInfo.departmentName&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">      &lt;!--手机 聘用形式  --&gt;</span><br><span class="line">      &lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;手机&quot;&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;userInfo.mobile&quot; /&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;聘用形式&quot;&gt;</span><br><span class="line">            &lt;el-select v-model=&quot;userInfo.formOfEmployment&quot; class=&quot;inputW&quot;&gt;</span><br><span class="line">              &lt;el-option</span><br><span class="line">                v-for=&quot;item in EmployeeEnum.hireType&quot;</span><br><span class="line">                :key=&quot;item.id&quot;</span><br><span class="line">                :label=&quot;item.value&quot;</span><br><span class="line">                :value=&quot;item.id&quot;</span><br><span class="line">              /&gt;</span><br><span class="line">            &lt;/el-select&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">      &lt;!-- 员工照片 --&gt;</span><br><span class="line">      &lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;员工头像&quot;&gt;</span><br><span class="line">            &lt;!-- 放置上传图片 --&gt;</span><br><span class="line">           </span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">      &lt;!-- 保存个人信息 --&gt;</span><br><span class="line">      &lt;el-row class=&quot;inline-info&quot; type=&quot;flex&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;保存更新&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">    &lt;!-- 基础信息 --&gt;</span><br><span class="line">    &lt;el-form label-width=&quot;220px&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;基础信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;最高学历&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.theHighestDegreeOfEducation&quot; class=&quot;inputW2&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.highestDegree&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;!-- 个人头像 --&gt;</span><br><span class="line">        &lt;!-- 员工照片 --&gt;</span><br><span class="line"></span><br><span class="line">        &lt;el-form-item label=&quot;员工照片&quot;&gt;</span><br><span class="line">          &lt;!-- 放置上传图片 --&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;国家/地区&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.nationalArea&quot; class=&quot;inputW2&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.isOverseas&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;护照号&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.passportNo&quot; placeholder=&quot;正规护照格式&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;身份证号&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.idNumber&quot; placeholder=&quot;正规身份证格式&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;籍贯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.nativePlace&quot; placeholder=&quot;籍贯地址&quot; class=&quot;inputW5&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;民族&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.nation&quot; placeholder=&quot;请输入民族&quot; class=&quot;inputW2&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;婚姻状况&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.maritalStatus&quot; class=&quot;inputW2&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.maritaStatus&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;生日&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.birthday&quot; placeholder=&quot;示例 0323&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;年龄&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.age&quot; type=&quot;number&quot; class=&quot;inputW2&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;星座&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.constellation&quot; class=&quot;inputW2&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.constellation&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;血型&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.bloodType&quot; class=&quot;inputW2&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.bloodType&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;户籍所在地&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.domicile&quot; class=&quot;inputW5&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;政治面貌&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.politicalOutlook&quot; class=&quot;inputW2&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;入党时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.timeToJoinTheParty&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            class=&quot;inputW&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;存档机构&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.archivingOrganization&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;子女状态&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.stateOfChildren&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;子女有无商业险&quot;&gt;</span><br><span class="line">          &lt;el-radio-group v-model=&quot;formData.doChildrenHaveCommercialInsurance&quot;&gt;</span><br><span class="line">            &lt;el-radio label=&quot;1&quot;&gt;有&lt;/el-radio&gt;</span><br><span class="line">            &lt;el-radio label=&quot;2&quot;&gt;无&lt;/el-radio&gt;</span><br><span class="line">          &lt;/el-radio-group&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;有无违法违纪状态&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.isThereAnyViolationOfLawOrDiscipline&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;有无重大病史&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.areThereAnyMajorMedicalHistories&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 通讯信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;通讯信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;QQ&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.qq&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;微信&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.wechat&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;现居住地&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.placeOfResidence&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;通讯地址&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.postalAddress&quot; placeholder=&quot;请输入&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;联系手机&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.contactTheMobilePhone&quot; placeholder=&quot;11位字符&quot; maxlength=&quot;11&quot; class=&quot;inputW&quot; @change.native=&quot;handlePhone(2)&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;个人邮箱&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.personalMailbox&quot; placeholder=&quot;请输入&quot; type=&quot;mail&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;紧急联系人&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.emergencyContact&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;紧急联系电话&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.emergencyContactNumber&quot; placeholder=&quot;11位字符&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 账号信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;账号信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;社保电脑号&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.socialSecurityComputerNumber&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;公积金账号&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.providentFundAccount&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;银行卡号&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.bankCardNumber&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;开户行&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.openingBank&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 教育信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;教育信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;学历类型&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.educationalType&quot; placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.educationType&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;毕业学校&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.graduateSchool&quot; placeholder=&quot;请输入&quot; class=&quot;inputW2&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;入学时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker v-model=&quot;formData.enrolmentTime&quot; type=&quot;data&quot; placeholder=&quot;请输入时间&quot; class=&quot;inputW&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;毕业时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker v-model=&quot;formData.graduationTime&quot; type=&quot;data&quot; placeholder=&quot;请输入时间&quot; class=&quot;inputW&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;专业&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.major&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 从业信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;从业信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;上家公司&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.homeCompany&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;职称&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.title&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;有无竞业限制&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.isThereAnyCompetitionRestriction&quot; placeholder=&quot;请输入&quot; style=&quot;width:80%&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;备注&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.remarks&quot; type=&quot;textarea&quot; placeholder=&quot;请输入备注&quot; style=&quot;width:80%&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;!-- 保存员工信息 --&gt;</span><br><span class="line">        &lt;el-row class=&quot;inline-info&quot; type=&quot;flex&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">          &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">            &lt;el-button type=&quot;primary&quot; @click=&quot;savePersonal&quot;&gt;保存更新&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;</span><br><span class="line">          &lt;/el-col&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>本章节个人数据过于**<code>繁杂，庞大</code>**，同学们在开发期间，拷贝代码即可，我们只写关键部位的代码</p>
</blockquote>
<p><strong>定义user-info的数据</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EmployeeEnum <span class="keyword">from</span> <span class="string">&#x27;@/api/constant/employees&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userId</span>: <span class="built_in">this</span>.$route.params.id,</span><br><span class="line">      EmployeeEnum, <span class="comment">// 员工枚举数据</span></span><br><span class="line">      <span class="attr">userInfo</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">formData</span>: &#123;</span><br><span class="line">        <span class="attr">userId</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 用户名</span></span><br><span class="line">        <span class="attr">sex</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 性别</span></span><br><span class="line">        <span class="attr">mobile</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 手机</span></span><br><span class="line">        <span class="attr">companyId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 公司id</span></span><br><span class="line">        <span class="attr">departmentName</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 部门名称</span></span><br><span class="line">        <span class="comment">//  onTheJobStatus: &#x27;&#x27;, // 在职状态 no</span></span><br><span class="line">        <span class="attr">dateOfBirth</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 出生日期</span></span><br><span class="line">        <span class="attr">timeOfEntry</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 入职时间</span></span><br><span class="line">        <span class="attr">theHighestDegreeOfEducation</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 最高学历</span></span><br><span class="line">        <span class="attr">nationalArea</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 国家</span></span><br><span class="line">        <span class="attr">passportNo</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 护照号</span></span><br><span class="line">        <span class="attr">idNumber</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 身份证号</span></span><br><span class="line">        <span class="attr">idCardPhotoPositive</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 身份证照正</span></span><br><span class="line">        <span class="attr">idCardPhotoBack</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 身份证照正</span></span><br><span class="line">        <span class="attr">nativePlace</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 籍贯</span></span><br><span class="line">        <span class="attr">nation</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 民族</span></span><br><span class="line">        <span class="attr">englishName</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 英文名字</span></span><br><span class="line">        <span class="attr">maritalStatus</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 婚姻状况</span></span><br><span class="line">        <span class="attr">staffPhoto</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 员工照片</span></span><br><span class="line">        <span class="attr">birthday</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 生日</span></span><br><span class="line">        <span class="attr">zodiac</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 属相</span></span><br><span class="line">        <span class="attr">age</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 年龄</span></span><br><span class="line">        <span class="attr">constellation</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 星座</span></span><br><span class="line">        <span class="attr">bloodType</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 血型</span></span><br><span class="line">        <span class="attr">domicile</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 户籍所在地</span></span><br><span class="line">        <span class="attr">politicalOutlook</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 政治面貌</span></span><br><span class="line">        <span class="attr">timeToJoinTheParty</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 入党时间</span></span><br><span class="line">        <span class="attr">archivingOrganization</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 存档机构</span></span><br><span class="line">        <span class="attr">stateOfChildren</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 子女状态</span></span><br><span class="line">        <span class="attr">doChildrenHaveCommercialInsurance</span>: <span class="string">&#x27;1&#x27;</span>, <span class="comment">// 保险状态</span></span><br><span class="line">        <span class="attr">isThereAnyViolationOfLawOrDiscipline</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 违法违纪状态</span></span><br><span class="line">        <span class="attr">areThereAnyMajorMedicalHistories</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 重大病史</span></span><br><span class="line">        <span class="attr">qq</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// QQ</span></span><br><span class="line">        <span class="attr">wechat</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 微信</span></span><br><span class="line">        <span class="attr">residenceCardCity</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 居住证城市</span></span><br><span class="line">        <span class="attr">dateOfResidencePermit</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 居住证办理日期</span></span><br><span class="line">        <span class="attr">residencePermitDeadline</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 居住证截止日期</span></span><br><span class="line">        <span class="attr">placeOfResidence</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 现居住地</span></span><br><span class="line">        <span class="attr">postalAddress</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 通讯地址</span></span><br><span class="line">        <span class="attr">contactTheMobilePhone</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 联系手机</span></span><br><span class="line">        <span class="attr">personalMailbox</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 个人邮箱</span></span><br><span class="line">        <span class="attr">emergencyContact</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 紧急联系人</span></span><br><span class="line">        <span class="attr">emergencyContactNumber</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 紧急联系电话</span></span><br><span class="line">        <span class="attr">socialSecurityComputerNumber</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 社保电脑号</span></span><br><span class="line">        <span class="attr">providentFundAccount</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 公积金账号</span></span><br><span class="line">        <span class="attr">bankCardNumber</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 银行卡号</span></span><br><span class="line">        <span class="attr">openingBank</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 开户行</span></span><br><span class="line">        <span class="attr">educationalType</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 学历类型</span></span><br><span class="line">        <span class="attr">graduateSchool</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 毕业学校</span></span><br><span class="line">        <span class="attr">enrolmentTime</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 入学时间</span></span><br><span class="line">        <span class="attr">graduationTime</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 毕业时间</span></span><br><span class="line">        <span class="attr">major</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 专业</span></span><br><span class="line">        <span class="attr">graduationCertificate</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 毕业证书</span></span><br><span class="line">        <span class="attr">certificateOfAcademicDegree</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 学位证书</span></span><br><span class="line">        <span class="attr">homeCompany</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 上家公司</span></span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 职称</span></span><br><span class="line">        <span class="attr">resume</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 简历</span></span><br><span class="line">        <span class="attr">isThereAnyCompetitionRestriction</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 有无竞业限制</span></span><br><span class="line">        <span class="attr">proofOfDepartureOfFormerCompany</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 前公司离职证明</span></span><br><span class="line">        <span class="attr">remarks</span>: <span class="string">&#x27;&#x27;</span> <span class="comment">// 备注</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>在detail.vue组件中，注册并使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-tab-pane label=&quot;个人详情&quot;&gt;</span><br><span class="line">           &lt;!-- 放置个人详情 --&gt;</span><br><span class="line">           &lt;component :is=&quot;userComponent&quot; /&gt;</span><br><span class="line">           &lt;!-- &lt;user-info /&gt; --&gt;</span><br><span class="line"> &lt;/el-tab-pane&gt;</span><br></pre></td></tr></table></figure>

<p>在以上代码中，我们使用了动态组件<strong>component</strong>，它通过 **<code>is</code><strong>属性来绑定需要显示在该位置的组件，is属性可以直接为</strong><code>注册组件</code>**的组件名称即可</p>
<h3 id="封装岗位组件"><a href="#封装岗位组件" class="headerlink" title="封装岗位组件"></a>封装岗位组件</h3><p>同理，封装岗位组件</p>
<p><strong>封装岗位组件</strong>  <strong><code>src/views/employee/components/job-info.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;job-info&quot;&gt;</span><br><span class="line">    &lt;!-- 基础信息 --&gt;</span><br><span class="line">    &lt;el-form label-width=&quot;220px&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;基础信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;岗位&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.post&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;!-- &lt;el-form-item label=&quot;转正日期&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.dateOfCorrection&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt; --&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;转正状态&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.stateOfCorrection&quot; placeholder=&quot;请选择&quot; disabled&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.stateOfCorrection&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;职级&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.rank&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;转正评价&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.correctionEvaluation&quot; type=&quot;textarea&quot; placeholder=&quot;1-300位字符&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;汇报对象&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.reportId&quot; filterable placeholder=&quot;请选择&quot; class=&quot;inputW&quot;&gt;</span><br><span class="line">            &lt;el-option v-for=&quot;item in depts&quot; :key=&quot;item.id&quot; :label=&quot;item.username&quot; :value=&quot;item.id&quot; /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;HRBP&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.hrbp&quot; filterable placeholder=&quot;请选择&quot; class=&quot;inputW&quot;&gt;</span><br><span class="line">            &lt;el-option v-for=&quot;item in depts&quot; :key=&quot;item.id&quot; :label=&quot;item.username&quot; :value=&quot;item.id&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item class=&quot;formInfo&quot; label=&quot;调整司龄(天)：&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.adjustmentAgedays&quot; type=&quot;number&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;首次参加工作时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.workingTimeForTheFirstTime&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;调整工龄&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.adjustmentOfLengthOfService&quot; placeholder=&quot;0.00年&quot; class=&quot;inputW&quot; disabled /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 合同信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;合同信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item class=&quot;formInfo&quot; label=&quot;首次合同开始时间：&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.initialContractStartTime&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;首次合同结束时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.firstContractTerminationTime&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;现合同开始时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.currentContractStartTime&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;现合同结束时间&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;formData.closingTimeOfCurrentContract	&quot;</span><br><span class="line">            type=&quot;date&quot;</span><br><span class="line">            placeholder=&quot;选择日期&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;合同期限&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.contractPeriod&quot; class=&quot;filter-item&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.contractPeriod&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;续签次数&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.renewalNumber&quot; class=&quot;filter-item&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.renewalCount&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.value&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 招聘信息 --&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot;&gt;招聘信息&lt;/div&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;其他招聘渠道&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.otherRecruitmentChannels&quot; placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.resumeSource&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.value&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;招聘渠道&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.recruitmentChannels&quot; placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.resumeSource&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;社招/校招&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;formData.socialRecruitment&quot; placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in EmployeeEnum.hireSourceType&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              :label=&quot;item.label&quot;</span><br><span class="line">              :value=&quot;item.value&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;推荐企业/人&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;formData.recommenderBusinessPeople&quot; placeholder=&quot;请输入&quot; class=&quot;infoPosition inputW&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 从业信息 --&gt;</span><br><span class="line">      &lt;el-form-item&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveJob&quot;&gt;保存更新&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>定义岗位数据</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EmployeeEnum <span class="keyword">from</span> <span class="string">&#x27;@/api/constant/employees&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userId</span>: <span class="built_in">this</span>.$route.params.id,</span><br><span class="line">      <span class="attr">depts</span>: [],</span><br><span class="line">      EmployeeEnum,</span><br><span class="line">      <span class="attr">formData</span>: &#123;</span><br><span class="line">        <span class="attr">adjustmentAgedays</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 调整司龄天</span></span><br><span class="line">        <span class="attr">adjustmentOfLengthOfService</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 调整工龄天</span></span><br><span class="line">        <span class="attr">closingTimeOfCurrentContract</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 现合同结束时间</span></span><br><span class="line">        <span class="attr">companyId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 公司ID</span></span><br><span class="line">        <span class="attr">contractDocuments</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 合同文件</span></span><br><span class="line">        <span class="attr">contractPeriod</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 合同期限</span></span><br><span class="line">        <span class="attr">correctionEvaluation</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//  转正评价</span></span><br><span class="line">        <span class="attr">currentContractStartTime</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 现合同开始时间</span></span><br><span class="line">        <span class="attr">firstContractTerminationTime</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 首次合同结束时间</span></span><br><span class="line">        <span class="attr">hrbp</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// HRBP</span></span><br><span class="line">        <span class="attr">initialContractStartTime</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 首次合同开始时间</span></span><br><span class="line">        <span class="attr">otherRecruitmentChannels</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 其他招聘渠道</span></span><br><span class="line">        <span class="attr">post</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 岗位</span></span><br><span class="line">        <span class="attr">rank</span>: <span class="literal">null</span>, <span class="comment">// 职级</span></span><br><span class="line">        <span class="attr">recommenderBusinessPeople</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 推荐企业人</span></span><br><span class="line">        <span class="attr">recruitmentChannels</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 招聘渠道</span></span><br><span class="line">        <span class="attr">renewalNumber</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 续签次数</span></span><br><span class="line">        <span class="attr">reportId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 汇报对象</span></span><br><span class="line">        <span class="attr">reportName</span>: <span class="literal">null</span>, <span class="comment">// 汇报对象</span></span><br><span class="line">        <span class="attr">socialRecruitment</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 社招校招</span></span><br><span class="line">        <span class="attr">stateOfCorrection</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 转正状态</span></span><br><span class="line">        <span class="attr">taxableCity</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 纳税城市</span></span><br><span class="line">        <span class="attr">userId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 员工ID</span></span><br><span class="line">        <span class="attr">workMailbox</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 工作邮箱</span></span><br><span class="line">        <span class="attr">workingCity</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 工作城市</span></span><br><span class="line">        <span class="attr">workingTimeForTheFirstTime</span>: <span class="string">&#x27;&#x27;</span> <span class="comment">// 首次参加工作时间</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>在detail.vue组件中，注册并使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-tab-pane label=&quot;岗位详情&quot;&gt;</span><br><span class="line">           &lt;!-- 放置岗位详情 --&gt;</span><br><span class="line">           &lt;component :is=&quot;JobInfo&quot; /&gt;</span><br><span class="line"> &lt;/el-tab-pane&gt;</span><br></pre></td></tr></table></figure>

<p>**<code>本节任务</code>**：完成个人组件和岗位组件封装</p>
<h2 id="员工个人信息和岗位信息-读取-保存"><a href="#员工个人信息和岗位信息-读取-保存" class="headerlink" title="员工个人信息和岗位信息-读取-保存"></a>员工个人信息和岗位信息-读取-保存</h2><p>**<code>目标</code>**：实现个人信息的岗位信息的读取和校验，保存</p>
<h3 id="读取个人保存个人信息"><a href="#读取个人保存个人信息" class="headerlink" title="读取个人保存个人信息"></a>读取个人保存个人信息</h3><blockquote>
<p>这个环节里面大部分都是繁杂的属性和重复的过程，所以该环节直接将过程代码拷贝到项目中即可</p>
</blockquote>
<p>封装 <strong>读取个人信息</strong> <strong>保存个人信息</strong>  <strong>读取岗位信息</strong> <strong>保存岗位信息</strong>  </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *  读取用户详情的基础信息</span></span><br><span class="line"><span class="comment"> * **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getPersonalDetail</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/employees/<span class="subst">$&#123;id&#125;</span>/personalInfo`</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** *</span></span><br><span class="line"><span class="comment"> *  更新用户详情的基础信息</span></span><br><span class="line"><span class="comment"> * **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">updatePersonal</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/employees/<span class="subst">$&#123;data.userId&#125;</span>/personalInfo`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** **</span></span><br><span class="line"><span class="comment"> * 获取用户的岗位信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ****/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getJobDetail</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/employees/<span class="subst">$&#123;id&#125;</span>/jobs`</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 保存岗位信息</span></span><br><span class="line"><span class="comment"> * ****/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">updateJob</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/employees/<span class="subst">$&#123;data.userId&#125;</span>/jobs`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>读取，保存个人信息</strong>  <strong><code>user-info</code></strong>  需要注意：这里的保存实际上分成了两个接口，这是接口的设计，我们只能遵守</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getPersonalDetail, updatePersonal, saveUserDetailById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/employees&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getUserDetailById &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"> <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getPersonalDetail()</span><br><span class="line">    <span class="built_in">this</span>.getUserDetailById()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getPersonalDetail</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.formData = <span class="keyword">await</span> getPersonalDetail(<span class="built_in">this</span>.userId) <span class="comment">// 获取员工数据</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">savePersonal</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> updatePersonal(&#123; ...this.formData, <span class="attr">id</span>: <span class="built_in">this</span>.userId &#125;)</span><br><span class="line">      <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存成功&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">saveUser</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">//  调用父组件</span></span><br><span class="line">      <span class="keyword">await</span> saveUserDetailById(<span class="built_in">this</span>.userInfo)</span><br><span class="line">      <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存成功&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getUserDetailById</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.userInfo = <span class="keyword">await</span> getUserDetailById(<span class="built_in">this</span>.userId)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="读取保存岗位信息"><a href="#读取保存岗位信息" class="headerlink" title="读取保存岗位信息"></a>读取保存岗位信息</h3><p><strong>读取，保存岗位信息</strong>  <strong><code>job-info</code></strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getEmployeeSimple, updateJob, getJobDetail &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/employees&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.getJobDetail()</span><br><span class="line">  <span class="built_in">this</span>.getEmployeeSimple()</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">getJobDetail</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.formData = <span class="keyword">await</span> getJobDetail(<span class="built_in">this</span>.userId)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取员工列表</span></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">getEmployeeSimple</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.depts = <span class="keyword">await</span> getEmployeeSimple()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 保存岗位信息</span></span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">saveJob</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> updateJob(<span class="built_in">this</span>.formData)</span><br><span class="line">    <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存岗位信息成功&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 实现个人信息的岗位信息的读取和校验，保存</p>
<h2 id="配置腾讯云Cos"><a href="#配置腾讯云Cos" class="headerlink" title="配置腾讯云Cos"></a>配置腾讯云Cos</h2><p>**<code>目标</code>**： 配置一个腾讯云cos</p>
<blockquote>
<p>由于上课的开发的特殊性，我们不希望把所有的图片都上传到我们自己的官方服务器上，这里我们可以采用一个腾讯云的图片方案</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145955.png" alt="image-20200805200831035"></p>
<blockquote>
<p>上边图的意思就是说，我们找一个可以免费上传图片的服务器，帮我们**<code>代管图片</code><strong>，我们在自己的数据库里只保存一个地址就行， 这其实也是很多项目的处理方案，会有一个</strong><code>公共的文件服务器</code>**</p>
</blockquote>
<p>第一步，我们必须先拥有一个<a target="_blank" rel="noopener" href="https://cloud.tencent.com/login?s_url=https://console.cloud.tencent.com/">腾迅云</a>的开发者账号(<strong>小心腾讯云的广告电话</strong>)</p>
<blockquote>
<p>请按照腾讯云的注册方式，注册自己的账号</p>
</blockquote>
<p>第二步，实名认证</p>
<blockquote>
<p>选择个人账户</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145956.png" alt="image-20200805201013078"></p>
<p><strong>填写个人身份信息</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145957.png" alt="image-20200805201230001"></p>
<p>下一步，扫描二维码授权</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145958.png" alt="image-20200805201318977"></p>
<p><strong>手机端授权</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120145959.png" alt="image-20200805201422567"></p>
<p>点击<strong>领取免费产品</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150000.png" alt="image-20200805201513338"></p>
<p><strong>选择对象存储COS</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150001.png" alt="image-20200805201559233"></p>
<blockquote>
<p>我们免费拥有**<code>6个月的50G流量</code>**的对象存储空间使用权限，足够我们上传用户头像的使用了</p>
</blockquote>
<p><strong>点击0元试用，开通服务</strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150002.png" alt="image-20200805201750662"></p>
<p>到这一步，账号的部分就操作完毕，接下来，我们需要来创建一个存储图片的存储桶</p>
<p>登录 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/cos5">对象存储控制台</a> ，<a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/13309">创建存储桶</a>。设置存储桶的权限为 <strong><code>公有读，私有写</code></strong></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150003.png" alt="image-20200806135409338"></p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150004.png" alt="image-20200916231600661"></p>
<p>设置cors规则</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150005.png" alt="image-20200916231949174"></p>
<p>AllowHeader 需配成<code>*</code>，如下图所示。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150006.png" alt="image-20200805211749522"></p>
<blockquote>
<p>因为我们本身没有域名，所以这里设置成**<code>*</code>**，仅限于测试，正式环境的话，这里需要配置真实的域名地址</p>
</blockquote>
<p>到这里，我们的腾讯云存储桶就设置好了。</p>
<h2 id="封装上传图片组件-上传组件需求分析"><a href="#封装上传图片组件-上传组件需求分析" class="headerlink" title="封装上传图片组件-上传组件需求分析"></a>封装上传图片组件-上传组件需求分析</h2><p><strong><code>目标</code></strong> 梳理整个的上传过程</p>
<p><strong>初始化cos对象参数</strong></p>
<table>
<thead>
<tr>
<th align="left">名称</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SecretId</td>
<td align="left">开发者拥有的项目身份识别 ID，用以身份认证，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
<tr>
<td align="left">SecretKey</td>
<td align="left">开发者拥有的项目身份密钥，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
</tbody></table>
<blockquote>
<p>注意，上述的参数我们在本次开发过程中，直接将参数放置在前端代码中存储，但是腾讯云本身是不建议这么做的，因为**<code>敏感信息</code>**放在前端很容易被捕获，由于我们本次是测试研发，所以这个过程可以忽略</p>
<p>正确的做法应该是，通过网站调用接口换取敏感信息</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/11459">相关文档</a></p>
<p>实例化 上传sdk</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> cos = <span class="keyword">new</span> COS(&#123;</span><br><span class="line">    <span class="attr">SecretId</span>: <span class="string">&#x27;COS_SECRETID&#x27;</span>, <span class="comment">// 身份识别 ID</span></span><br><span class="line">    <span class="attr">SecretKey</span>: <span class="string">&#x27;COS_SECRETKEY&#x27;</span>, <span class="comment">// 身份密钥</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>到目前为止，我们上传图片准备的内容就已经OK，接下来，我们在**<code>src/componets</code>** 新建一个**<code>ImageUpload</code>** 组件</p>
</blockquote>
<p>该组件需要满足什么要求呢？</p>
<ol>
<li>可以显示传入的图片地址</li>
<li>可以删除传入的图片地址</li>
<li>可以上传图片到云服务器</li>
<li>上传到腾讯云之后，可以返回图片地址，显示  </li>
<li>上传成功之后，可以回调成功函数</li>
</ol>
<p>这个上传组件简单吗？</p>
<p><strong><code>no ! ! !</code></strong></p>
<p>看似需求很明确，但是它真正的实现很复杂，我们通过一个图来看一下</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150007.png" alt="image-20200806174643390"></p>
<p>从上图中，我们可以看到，实际上是有两种场景的，本地场景和已经上传的场景</p>
<p>下个章节，针对这个场景我们进行开发</p>
<h2 id="封装上传组件-代码实现"><a href="#封装上传组件-代码实现" class="headerlink" title="封装上传组件-代码实现"></a>封装上传组件-代码实现</h2><p>**<code>目标</code>**实现上传组件的代码部分</p>
<blockquote>
<p>JavaScript SDK 需浏览器支持基本的 HTML5 特性（支持 IE10 以上浏览器），以便支持 ajax 上传文件和计算文件 MD5 值。</p>
</blockquote>
<h3 id="新建文件上传组件"><a href="#新建文件上传组件" class="headerlink" title="新建文件上传组件"></a>新建文件上传组件</h3><p><strong>安装JavaScript SDK</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm i cos-js-sdk-v5 --save</span><br></pre></td></tr></table></figure>

<p><strong>新建上传图片组件</strong> <strong><code>src/components/ImageUpload/index.vue</code></strong></p>
<blockquote>
<p>上传组件，我们可以沿用element的el-upload组件,并且采用照片墙的模式 <strong><code>list-type=&quot;picture-card&quot;</code></strong></p>
</blockquote>
<p><strong>放置el-upload组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload list-type=&quot;picture-card&quot;&gt;</span><br><span class="line">     &lt;i class=&quot;el-icon-plus&quot; /&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局注册组件</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PageTools <span class="keyword">from</span> <span class="string">&#x27;./PageTools&#x27;</span></span><br><span class="line"><span class="keyword">import</span> UploadExcel <span class="keyword">from</span> <span class="string">&#x27;./UploadExcel&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ImageUpload <span class="keyword">from</span> <span class="string">&#x27;./ImageUpload&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">install</span>(<span class="params">Vue</span>)</span> &#123;</span><br><span class="line">    Vue.component(<span class="string">&#x27;PageTools&#x27;</span>, PageTools) <span class="comment">// 注册工具栏组件</span></span><br><span class="line">    Vue.component(<span class="string">&#x27;UploadExcel&#x27;</span>, UploadExcel) <span class="comment">// 注册导入excel组件</span></span><br><span class="line">    Vue.component(<span class="string">&#x27;ImageUpload&#x27;</span>, ImageUpload) <span class="comment">// 注册导入上传组件</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="点击图片进行预览"><a href="#点击图片进行预览" class="headerlink" title="点击图片进行预览"></a>点击图片进行预览</h3><p><strong>限定上传的图片数量和action</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload list-type=&quot;picture-card&quot; :limit=&quot;1&quot; action=&quot;#&quot;&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>action为什么给#， 因为前面我们讲过了，我们要上传到腾讯云，需要自定义的上传方式,action给个#防止报错</p>
</blockquote>
<p><strong>预览</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">fileList</span>: [], <span class="comment">// 图片地址设置为数组 </span></span><br><span class="line">      <span class="attr">showDialog</span>: <span class="literal">false</span>, <span class="comment">// 控制显示弹层</span></span><br><span class="line">      <span class="attr">imgUrl</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">   <span class="function"><span class="title">preview</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 这里应该弹出一个层 层里是点击的图片地址</span></span><br><span class="line">    <span class="built_in">this</span>.imgUrl = file.url</span><br><span class="line">    <span class="built_in">this</span>.showDialog = <span class="literal">true</span></span><br><span class="line">&#125;,  </span><br></pre></td></tr></table></figure>

<p><strong>预览弹层</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-dialog title=&quot;图片&quot; :visible.sync=&quot;showDialog&quot;&gt;</span><br><span class="line">    &lt;img :src=&quot;imgUrl&quot; style=&quot;width:100%&quot; alt=&quot;&quot;&gt;</span><br><span class="line"> &lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure>

<h3 id="根据上传数量控制上传按钮"><a href="#根据上传数量控制上传按钮" class="headerlink" title="根据上传数量控制上传按钮"></a>根据上传数量控制上传按钮</h3><p><strong>控制上传显示</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">   <span class="comment">// 设定一个计算属性 判断是否已经上传完了一张</span></span><br><span class="line">   <span class="function"><span class="title">fileComputed</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="built_in">this</span>.fileList.length === <span class="number">1</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"> &lt;el-upload</span><br><span class="line">      :on-preview=<span class="string">&quot;preview&quot;</span></span><br><span class="line">      :on-remove=<span class="string">&quot;handleRemove&quot;</span></span><br><span class="line">      :on-change=<span class="string">&quot;changeFile&quot;</span></span><br><span class="line">      :file-list=<span class="string">&quot;fileList&quot;</span></span><br><span class="line">      list-type=<span class="string">&quot;picture-card&quot;</span></span><br><span class="line">      action=<span class="string">&quot;#&quot;</span></span><br><span class="line">      :limit=<span class="string">&quot;1&quot;</span></span><br><span class="line">      :class=<span class="string">&quot;&#123;disabled: fileComputed &#125;&quot;</span></span><br><span class="line">    &gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.disabled .el-upload--picture-card &#123;</span><br><span class="line">  display: none</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="删除图片和添加图片"><a href="#删除图片和添加图片" class="headerlink" title="删除图片和添加图片"></a>删除图片和添加图片</h3><p><strong>删除文件</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">handleRemove</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// file是点击删除的文件</span></span><br><span class="line">  <span class="comment">//   将原来的文件给排除掉了 剩下的就是最新的数组了</span></span><br><span class="line">    <span class="built_in">this</span>.fileList = <span class="built_in">this</span>.fileList.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.uid !== file.uid)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>添加文件</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改文件时触发</span></span><br><span class="line"><span class="comment">// 此时可以用fileList 因为该方法会进来很多遍 不能每次都去push</span></span><br><span class="line"><span class="comment">// fileList因为fileList参数是当前传进来的最新参数 我们只需要将其转化成数组即可 需要转化成一个新的数组</span></span><br><span class="line"><span class="comment">// [] =&gt; [...fileList] [] =&gt; fileList.map()</span></span><br><span class="line"><span class="comment">// 上传成功之后 还会进来 需要实现上传代码的逻辑 这里才会成功</span></span><br><span class="line"><span class="function"><span class="title">changeFile</span>(<span class="params">file, fileList</span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.fileList = fileList.map(<span class="function"><span class="params">item</span> =&gt;</span> item)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="上传之前检查"><a href="#上传之前检查" class="headerlink" title="上传之前检查"></a>上传之前检查</h3><blockquote>
<p>控制上传图片的类型和上传大小， 如果不满足条件 返回false上传就会停止</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">beforeUpload</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 要开始做文件上传的检查了</span></span><br><span class="line">  <span class="comment">// 文件类型 文件大小</span></span><br><span class="line">  <span class="keyword">const</span> types = [<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="string">&#x27;image/gif&#x27;</span>, <span class="string">&#x27;image/bmp&#x27;</span>, <span class="string">&#x27;image/png&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (!types.includes(file.type)) &#123;</span><br><span class="line">    <span class="built_in">this</span>.$message.error(<span class="string">&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//  检查大小</span></span><br><span class="line">  <span class="keyword">const</span> maxSize = <span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">  <span class="keyword">if</span> (maxSize &lt; file.size) &#123;</span><br><span class="line">    <span class="built_in">this</span>.$message.error(<span class="string">&#x27;图片大小最大不能超过5M&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="上传动作调用上传腾讯云"><a href="#上传动作调用上传腾讯云" class="headerlink" title="上传动作调用上传腾讯云"></a>上传动作调用上传腾讯云</h3><p><strong>上传动作为el-upload的http-request属性</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">:http-request=<span class="string">&quot;upload&quot;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 自定义上传动作 有个参数 有个file对象，是我们需要上传到腾讯云服务器的内容</span></span><br><span class="line">   <span class="function"><span class="title">upload</span>(<span class="params">params</span>)</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(params.file)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们需要在该方法中，调用腾讯云的上传方法</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/35649#.E7.AE.80.E5.8D.95.E4.B8.8A.E4.BC.A0.E5.AF.B9.E8.B1.A1">腾讯云文档地址</a></p>
<p>身份ID和密钥可以通过腾讯云平台获取</p>
<p>登录 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">访问管理控制台</a> ，获取您的项目 SecretId 和 SecretKey。</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150008.png" alt="image-20200805211539544"></p>
<p>实现代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 进行上传操作</span></span><br><span class="line"><span class="function"><span class="title">upload</span>(<span class="params">params</span>)</span> &#123;</span><br><span class="line"><span class="comment">//   console.log(params.file)</span></span><br><span class="line">  <span class="keyword">if</span> (params.file) &#123;</span><br><span class="line">    <span class="comment">// 执行上传操作</span></span><br><span class="line">    cos.putObject(&#123;</span><br><span class="line">      <span class="attr">Bucket</span>: <span class="string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="comment">// 存储桶</span></span><br><span class="line">      <span class="attr">Region</span>: <span class="string">&#x27;ap-beijing&#x27;</span>, <span class="comment">// 地域</span></span><br><span class="line">      <span class="attr">Key</span>: params.file.name, <span class="comment">// 文件名</span></span><br><span class="line">      <span class="attr">Body</span>: params.file, <span class="comment">// 要上传的文件对象</span></span><br><span class="line">      <span class="attr">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span> <span class="comment">// 上传的模式类型 直接默认 标准模式即可</span></span><br><span class="line">      <span class="comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span></span><br><span class="line">    &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// data返回数据之后 应该如何处理</span></span><br><span class="line">      <span class="built_in">console</span>.log(err || data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="上传成功之后处理返回数据"><a href="#上传成功之后处理返回数据" class="headerlink" title="上传成功之后处理返回数据"></a>上传成功之后处理返回数据</h3><blockquote>
<p>如何处理返回成功的返回数据</p>
</blockquote>
<p>确定要上传记录id</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">beforeUpload</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//   先检查文件类型</span></span><br><span class="line">    <span class="keyword">const</span> types = [<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="string">&#x27;image/gif&#x27;</span>, <span class="string">&#x27;image/bmp&#x27;</span>, <span class="string">&#x27;image/png&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (!types.some(<span class="function"><span class="params">item</span> =&gt;</span> item === file.type)) &#123;</span><br><span class="line">      <span class="comment">//   如果不存在</span></span><br><span class="line">      <span class="built_in">this</span>.$message.error(<span class="string">&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 上传终止</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 检查文件大小  5M 1M = 1024KB 1KB = 1024B</span></span><br><span class="line">    <span class="keyword">const</span> maxSize = <span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">    <span class="keyword">if</span> (file.size &gt; maxSize) &#123;</span><br><span class="line">      <span class="comment">//   超过了限制的文件大小</span></span><br><span class="line">      <span class="built_in">this</span>.$message.error(<span class="string">&#x27;上传的图片大小不能大于5M&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//   已经确定当前上传的就是当前的这个file了</span></span><br><span class="line">    <span class="built_in">this</span>.currentFileUid = file.uid</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 最后一定要return  true</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>处理返回数据</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 进行上传操作</span></span><br><span class="line"><span class="function"><span class="title">upload</span>(<span class="params">params</span>)</span> &#123;</span><br><span class="line"><span class="comment">//   console.log(params.file)</span></span><br><span class="line">  <span class="keyword">if</span> (params.file) &#123;</span><br><span class="line">    <span class="comment">// 执行上传操作</span></span><br><span class="line">    cos.putObject(&#123;</span><br><span class="line">      <span class="attr">Bucket</span>: <span class="string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="comment">// 存储桶</span></span><br><span class="line">      <span class="attr">Region</span>: <span class="string">&#x27;ap-beijing&#x27;</span>, <span class="comment">// 地域</span></span><br><span class="line">      <span class="attr">Key</span>: params.file.name, <span class="comment">// 文件名</span></span><br><span class="line">      <span class="attr">Body</span>: params.file, <span class="comment">// 要上传的文件对象</span></span><br><span class="line">      <span class="attr">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span> <span class="comment">// 上传的模式类型 直接默认 标准模式即可</span></span><br><span class="line">      <span class="comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span></span><br><span class="line">    &#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// data返回数据之后 应该如何处理</span></span><br><span class="line">      <span class="built_in">console</span>.log(err || data)</span><br><span class="line">      <span class="comment">// data中有一个statusCode === 200 的时候说明上传成功</span></span><br><span class="line">      <span class="keyword">if</span> (!err &amp;&amp; data.statusCode === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">//   此时说明文件上传成功  要获取成功的返回地址</span></span><br><span class="line">        <span class="comment">// fileList才能显示到上传组件上 此时我们要将fileList中的数据的url地址变成 现在上传成功的地址</span></span><br><span class="line">        <span class="comment">// 目前虽然是一张图片 但是请注意 我们的fileList是一个数组</span></span><br><span class="line">        <span class="comment">// 需要知道当前上传成功的是哪一张图片</span></span><br><span class="line">        <span class="built_in">this</span>.fileList = <span class="built_in">this</span>.fileList.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 去找谁的uid等于刚刚记录下来的id</span></span><br><span class="line">          <span class="keyword">if</span> (item.uid === <span class="built_in">this</span>.currentFileUid) &#123;</span><br><span class="line">            <span class="comment">// 将成功的地址赋值给原来的url属性</span></span><br><span class="line">            <span class="keyword">return</span> &#123; <span class="attr">url</span>: <span class="string">&#x27;http://&#x27;</span> + data.Location, <span class="attr">upload</span>: <span class="literal">true</span> &#125;</span><br><span class="line">            <span class="comment">// upload 为true 表示这张图片已经上传完毕 这个属性要为我们后期应用的时候做标记</span></span><br><span class="line">            <span class="comment">// 保存  =&gt; 图片有大有小 =&gt; 上传速度有快又慢 =&gt;要根据有没有upload这个标记来决定是否去保存</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> item</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 将上传成功的地址 回写到了fileList中 fileList变化  =》 upload组件 就会根据fileList的变化而去渲染视图</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们在fileList中设置了属性为upload为true的属性，表示该图片已经上传成功了，如果fileList还有upload不为true的数据，那就表示该图片还没有上传完毕</p>
</blockquote>
<h3 id="上传的进度条显示"><a href="#上传的进度条显示" class="headerlink" title="上传的进度条显示"></a>上传的进度条显示</h3><blockquote>
<p>为了再上传图片过程中显示进度条，我们可以使用element-ui的进度条显示当前的上传进度</p>
</blockquote>
<p><strong>放置进度条</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-progress v-if=&quot;showPercent&quot; style=&quot;width: 180px&quot; :percentage=&quot;percent&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>通过腾讯云sdk监听上传进度</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cos.putObject(&#123;</span><br><span class="line">         <span class="comment">// 配置</span></span><br><span class="line">         <span class="attr">Bucket</span>: <span class="string">&#x27;laogao-1302806742&#x27;</span>, <span class="comment">// 存储桶名称</span></span><br><span class="line">         <span class="attr">Region</span>: <span class="string">&#x27;ap-guangzhou&#x27;</span>, <span class="comment">// 存储桶地域</span></span><br><span class="line">         <span class="attr">Key</span>: params.file.name, <span class="comment">// 文件名作为key</span></span><br><span class="line">         <span class="attr">StorageClass</span>: <span class="string">&#x27;STANDARD&#x27;</span>, <span class="comment">// 此类写死</span></span><br><span class="line">         <span class="attr">Body</span>: params.file, <span class="comment">// 将本地的文件赋值给腾讯云配置</span></span><br><span class="line">         <span class="comment">// 进度条</span></span><br><span class="line">         <span class="attr">onProgress</span>: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">           <span class="built_in">this</span>.percent = params.percent * <span class="number">100</span></span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<p><strong>完整代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 放置一个上传组件 --&gt;</span><br><span class="line">    &lt;!-- action这里不写上传地址 因为我们是调用腾讯云cos 不是一个地址可以搞定的 要用自定义的上传 --&gt;</span><br><span class="line">    &lt;el-upload</span><br><span class="line">      :on-preview=&quot;preview&quot;</span><br><span class="line">      :on-remove=&quot;handleRemove&quot;</span><br><span class="line">      :on-change=&quot;changeFile&quot;</span><br><span class="line">      :before-upload=&quot;beforeUpload&quot;</span><br><span class="line">      :file-list=&quot;fileList&quot;</span><br><span class="line">      :http-request=&quot;upload&quot;</span><br><span class="line">      list-type=&quot;picture-card&quot;</span><br><span class="line">      action=&quot;#&quot;</span><br><span class="line">      :limit=&quot;1&quot;</span><br><span class="line">      :class=&quot;&#123;disabled: fileComputed &#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-plus&quot; /&gt;</span><br><span class="line">    &lt;/el-upload&gt;</span><br><span class="line">    &lt;!-- 进度条 --&gt;</span><br><span class="line">    &lt;el-progress v-if=&quot;showPercent&quot; style=&quot;width: 180px&quot; :percentage=&quot;percent&quot; /&gt;</span><br><span class="line">    &lt;!-- 放置一个弹层 --&gt;</span><br><span class="line">    &lt;!-- sync修饰符自动将弹层关闭了 --&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;图片&quot; :visible.sync=&quot;showDialog&quot;&gt;</span><br><span class="line">      &lt;img :src=&quot;imgUrl&quot; style=&quot;width:100%&quot; alt=&quot;&quot;&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import COS from &#x27;cos-js-sdk-v5&#x27; // 引入腾讯云的包</span><br><span class="line">// 需要实例化</span><br><span class="line">const cos = new COS(&#123;</span><br><span class="line">  SecretId: &#x27;AKID0mqfEWqlUzIbeSkGRL6c7ML6c0B93To9&#x27;,</span><br><span class="line">  SecretKey: &#x27;JFwNZdeRF2iOp03FFsGNDm44vWFitmNF&#x27;</span><br><span class="line">&#125;) // 实例化的包 已经具有了上传的能力 可以上传到该账号里面的存储桶了</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      fileList: [],</span><br><span class="line">      showDialog: false, // 控制图片的显示或者隐藏</span><br><span class="line">      imgUrl: &#x27;&#x27;, // 存储点击的图片地址</span><br><span class="line">      currentFileUid: &#x27;&#x27;, // 用一个变量 记住当前上传的图片id</span><br><span class="line">      percent: 0,</span><br><span class="line">      showPercent: false // 默认不显示进度条</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 设定一个计算属性 判断是否已经上传完了一张</span><br><span class="line">    fileComputed() &#123;</span><br><span class="line">      return this.fileList.length === 1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    preview(file) &#123;</span><br><span class="line">      // 这里应该弹出一个层 层里是点击的图片地址</span><br><span class="line">      this.imgUrl = file.url</span><br><span class="line">      this.showDialog = true</span><br><span class="line">    &#125;,</span><br><span class="line">    handleRemove(file) &#123;</span><br><span class="line">      // file是点击删除的文件</span><br><span class="line">    //   将原来的文件给排除掉了 剩下的就是最新的数组了</span><br><span class="line">      this.fileList = this.fileList.filter(item =&gt; item.uid !== file.uid)</span><br><span class="line">    &#125;,</span><br><span class="line">    // 修改文件时触发</span><br><span class="line">    // 此时可以用fileList 因为该方法会进来很多遍 不能每次都去push</span><br><span class="line">    // fileList因为fileList参数是当前传进来的最新参数 我们只需要将其转化成数组即可 需要转化成一个新的数组</span><br><span class="line">    // [] =&gt; [...fileList] [] =&gt; fileList.map()</span><br><span class="line">    // 上传成功之后 还会进来 需要实现上传代码的逻辑 这里才会成功</span><br><span class="line">    changeFile(file, fileList) &#123;</span><br><span class="line">      this.fileList = fileList.map(item =&gt; item)</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeUpload(file) &#123;</span><br><span class="line">      // 要开始做文件上传的检查了</span><br><span class="line">      // 文件类型 文件大小</span><br><span class="line">      const types = [&#x27;image/jpeg&#x27;, &#x27;image/gif&#x27;, &#x27;image/bmp&#x27;, &#x27;image/png&#x27;]</span><br><span class="line">      if (!types.includes(file.type)) &#123;</span><br><span class="line">        this.$message.error(&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;)</span><br><span class="line">        return false</span><br><span class="line">      &#125;</span><br><span class="line">      //  检查大小</span><br><span class="line">      const maxSize = 5 * 1024 * 1024</span><br><span class="line">      if (maxSize &lt; file.size) &#123;</span><br><span class="line">        this.$message.error(&#x27;图片大小最大不能超过5M&#x27;)</span><br><span class="line">        return false</span><br><span class="line">      &#125;</span><br><span class="line">      // file.uid</span><br><span class="line">      this.currentFileUid = file.uid // 记住当前的uid</span><br><span class="line">      this.showPercent = true</span><br><span class="line">      return true</span><br><span class="line">    &#125;,</span><br><span class="line">    // 自定义上传动作 有个参数 有个file对象，是我们需要上传到腾讯云服务器的内容</span><br><span class="line">    upload(params) &#123;</span><br><span class="line">      if (params.file) &#123;</span><br><span class="line">        //  上传文件到腾讯云</span><br><span class="line">        cos.putObject(&#123;</span><br><span class="line">          // 配置</span><br><span class="line">          Bucket: &#x27;laogao-1302806742&#x27;, // 存储桶名称</span><br><span class="line">          Region: &#x27;ap-guangzhou&#x27;, // 存储桶地域</span><br><span class="line">          Key: params.file.name, // 文件名作为key</span><br><span class="line">          StorageClass: &#x27;STANDARD&#x27;, // 此类写死</span><br><span class="line">          Body: params.file, // 将本地的文件赋值给腾讯云配置</span><br><span class="line">          // 进度条</span><br><span class="line">          onProgress: (params) =&gt; &#123;</span><br><span class="line">            this.percent = params.percent * 100</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, (err, data) =&gt; &#123;</span><br><span class="line">          // 需要判断错误与成功</span><br><span class="line">          if (!err &amp;&amp; data.statusCode === 200) &#123;</span><br><span class="line">            // 如果没有失败表示成功了</span><br><span class="line">            // 此时认为上传成功了</span><br><span class="line">            // this.currentFileUid</span><br><span class="line">            // 仍然有个小问题， 比如此时我们正在上传，但是调用了保存，保存在上传过程中进行，</span><br><span class="line">            // 此时上传还没有完成  此时可以这样做 ： 给所有上传成功的图片 加一个属性 upload: true</span><br><span class="line">            this.fileList = this.fileList.map(item =&gt; &#123;</span><br><span class="line">              if (item.uid === this.currentFileUid) &#123;</span><br><span class="line">                //   upload为true表示 该图片已经成功上传到服务器，地址已经是腾讯云的地址了  就不可以执行保存了</span><br><span class="line">                return &#123; url: &#x27;http://&#x27; + data.Location, upload: true &#125; // 将本地的地址换成腾讯云地址</span><br><span class="line">              &#125;</span><br><span class="line">              return item</span><br><span class="line">            &#125;)</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">              this.showPercent = false // 隐藏进度条</span><br><span class="line">              this.percent = 0 // 进度归0</span><br><span class="line">            &#125;, 2000)</span><br><span class="line"></span><br><span class="line">            // 将腾讯云地址写入到fileList上 ，保存的时候 就可以从fileList中直接获取图片地址</span><br><span class="line"></span><br><span class="line">            // 此时注意，我们应该记住 当前上传的是哪个图片  上传成功之后，将图片的地址赋值回去</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.disabled .el-upload--picture-card &#123;</span><br><span class="line">  display: none</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>上传动作中，用到了上个小节中，我们注册的腾讯云cos的**<code>存储桶名称</code><strong>和</strong><code>地域名称</code>**</p>
</blockquote>
<p>通过上面的代码，我们会发现，我们把上传之后的图片信息都给了**<code>fileList数据</code><strong>，那么在应用时，就可以直接获取该实例的</strong><code>fileList数据即可</code>**</p>
<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 完成上传组件的封装</p>
<h2 id="在员工详情中应用上传组件"><a href="#在员工详情中应用上传组件" class="headerlink" title="在员工详情中应用上传组件"></a>在员工详情中应用上传组件</h2><p>**<code>目标</code>**：应用封装好的上传组件</p>
<h3 id="将员工的头像和证件照赋值给上传组件"><a href="#将员工的头像和证件照赋值给上传组件" class="headerlink" title="将员工的头像和证件照赋值给上传组件"></a>将员工的头像和证件照赋值给上传组件</h3><p>在**<code>user-info.vue</code>**中放置上传组件</p>
<p><strong>员工头像</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 员工照片 --&gt;</span><br><span class="line">    &lt;el-row class=&quot;inline-info&quot;&gt;</span><br><span class="line">      &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;员工头像&quot;&gt;</span><br><span class="line">          &lt;!-- 放置上传图片 --&gt;</span><br><span class="line">          &lt;image-upload ref=&quot;staffPhoto&quot; /&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br></pre></td></tr></table></figure>

<p><strong>读取时赋值头像</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 读取上半部分的内容</span></span><br><span class="line">   <span class="keyword">async</span> <span class="function"><span class="title">getUserDetailById</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="built_in">this</span>.userInfo = <span class="keyword">await</span> getUserDetailById(<span class="built_in">this</span>.userId)</span><br><span class="line">     <span class="keyword">if</span> (<span class="built_in">this</span>.userInfo.staffPhoto) &#123;</span><br><span class="line">       <span class="comment">// 这里我们赋值，同时需要给赋值的地址一个标记 upload: true</span></span><br><span class="line">       <span class="built_in">this</span>.$refs.staffPhoto.fileList = [&#123; <span class="attr">url</span>: <span class="built_in">this</span>.userInfo.staffPhoto, <span class="attr">upload</span>: <span class="literal">true</span> &#125;]</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p><strong>员工证件照</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;员工照片&quot;&gt;</span><br><span class="line">        &lt;!-- 放置上传图片 --&gt;</span><br><span class="line">        &lt;!-- ref不要重名 --&gt;</span><br><span class="line">        &lt;image-upload ref=&quot;myStaffPhoto&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>

<p><strong>读取时赋值照片</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 读取下半部分内容</span></span><br><span class="line">   <span class="keyword">async</span>  <span class="function"><span class="title">getPersonalDetail</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="built_in">this</span>.formData = <span class="keyword">await</span> getPersonalDetail(<span class="built_in">this</span>.userId)</span><br><span class="line">     <span class="keyword">if</span> (<span class="built_in">this</span>.formData.staffPhoto) &#123;</span><br><span class="line">       <span class="built_in">this</span>.$refs.myStaffPhoto.fileList = [&#123; <span class="attr">url</span>: <span class="built_in">this</span>.formData.staffPhoto, <span class="attr">upload</span>: <span class="literal">true</span> &#125;]</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="保存时处理头像和证件照的保存"><a href="#保存时处理头像和证件照的保存" class="headerlink" title="保存时处理头像和证件照的保存"></a>保存时处理头像和证件照的保存</h3><p><strong>当点击保存更新时，获取图片的内容</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>  <span class="function"><span class="title">saveUser</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 去读取 员工上传的头像</span></span><br><span class="line">    <span class="keyword">const</span> fileList = <span class="built_in">this</span>.$refs.staffPhoto.fileList <span class="comment">// 读取上传组件的数据</span></span><br><span class="line">    <span class="keyword">if</span> (fileList.some(<span class="function"><span class="params">item</span> =&gt;</span> !item.upload)) &#123;</span><br><span class="line">      <span class="comment">//  如果此时去找 upload为false的图片 找到了说明 有图片还没有上传完成</span></span><br><span class="line">      <span class="built_in">this</span>.$message.warning(<span class="string">&#x27;您当前还有图片没有上传完成！&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过合并 得到一个新对象</span></span><br><span class="line">    <span class="keyword">await</span> saveUserDetailById(&#123; ...this.userInfo, <span class="attr">staffPhoto</span>: fileList &amp;&amp; fileList.length ? fileList[<span class="number">0</span>].url : <span class="string">&#x27;&#x27;</span> &#125;)</span><br><span class="line">    <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存基本信息成功&#x27;</span>)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面代码中，upload如果为true，表示该图片已经完成上传，以此来判断图片是否已经上传完成</p>
</blockquote>
<p><strong>保存时读取头像</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">savePersonal</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> fileList = <span class="built_in">this</span>.$refs.myStaffPhoto.fileList</span><br><span class="line">   <span class="keyword">if</span> (fileList.some(<span class="function"><span class="params">item</span> =&gt;</span> !item.upload)) &#123;</span><br><span class="line">     <span class="comment">//  如果此时去找 upload为false的图片 找到了说明 有图片还没有上传完成</span></span><br><span class="line">     <span class="built_in">this</span>.$message.warning(<span class="string">&#x27;您当前还有图片没有上传完成！&#x27;</span>)</span><br><span class="line">     <span class="keyword">return</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">await</span> updatePersonal(&#123; ...this.formData, <span class="attr">staffPhoto</span>: fileList &amp;&amp; fileList.length ? fileList[<span class="number">0</span>].url : <span class="string">&#x27;&#x27;</span> &#125;)</span><br><span class="line">   <span class="built_in">this</span>.$message.success(<span class="string">&#x27;保存基础信息成功&#x27;</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> ： 在员工详情中应用上传组件</p>
<h2 id="员工列表显示图片"><a href="#员工列表显示图片" class="headerlink" title="员工列表显示图片"></a>员工列表显示图片</h2><p>**<code>目标</code>**：在员工列表中心显示图片</p>
<blockquote>
<p>员工的头像可以在列表项中添加一列来进行显示</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-table-column label=&quot;头像&quot; align=&quot;center&quot;&gt;</span><br><span class="line">            &lt;template slot-scope=&quot;&#123;row&#125;&quot;&gt;</span><br><span class="line">              &lt;img</span><br><span class="line">                slot=&quot;reference&quot;</span><br><span class="line">                v-imageerror=&quot;require(&#x27;@/assets/common/bigUserHeader.png&#x27;)&quot;</span><br><span class="line">                :src=&quot;row.staffPhoto &quot;</span><br><span class="line">                style=&quot;border-radius: 50%; width: 100px; height: 100px; padding: 10px&quot;</span><br><span class="line">                alt=&quot;&quot;</span><br><span class="line">              &gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">&lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们尝试用之前的指令来处理图片的异常问题，但是发现只有两三张图片能显示</p>
</blockquote>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150009.png" alt="image-20201028172654637"></p>
<blockquote>
<p>这是因为有的员工的头像的地址为空，给img赋值空的src不能触发错误事件，针对这一特点，我们需要对指令进行升级</p>
</blockquote>
<p>插入节点的钩子里面判断空， 然后在组件更新之后的钩子中同样判断空</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> imageerror = &#123;</span><br><span class="line">  <span class="function"><span class="title">inserted</span>(<span class="params">dom, options</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//   图片异常的逻辑</span></span><br><span class="line">    <span class="comment">//  监听img标签的错误事件  因为图片加载失败 会触发  onerror事件</span></span><br><span class="line">    dom.src = dom.src || options.value</span><br><span class="line"></span><br><span class="line">    dom.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 图片失败  赋值一个默认的图片</span></span><br><span class="line">      dom.src = options.value</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentUpdated</span>(<span class="params">dom, options</span>)</span> &#123;</span><br><span class="line">    dom.src = dom.src || options.value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样我们可以看到每个用户的头像了，如果没有头像则显示默认图片</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150010.png" alt="image-20201028173333103"></p>
<p>**<code>任务</code>**：员工列表显示图片</p>
<h2 id="图片地址生成二维码"><a href="#图片地址生成二维码" class="headerlink" title="图片地址生成二维码"></a>图片地址生成二维码</h2><p><strong><code>目标</code></strong> 将图片地址生成二维码显示</p>
<blockquote>
<p>我们想完成这样一个功能，当我们拥有头像地址时，将头像地址生成一个二维码，用手机扫码来访问</p>
</blockquote>
<p>首先，需要安装生成二维码的插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm i qrcode</span><br></pre></td></tr></table></figure>

<blockquote>
<p>qrcode的用法是</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">QrCode.toCanvas(dom, info)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>dom为一个canvas的dom对象， info为转化二维码的信息</p>
</blockquote>
<p>我们尝试将canvas标签放到dialog的弹层中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-dialog title=&quot;二维码&quot; :visible.sync=&quot;showCodeDialog&quot; @opened=&quot;showQrCode&quot; @close=&quot;imgUrl=&#x27;&#x27;&quot;&gt;</span><br><span class="line">  &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">    &lt;canvas ref=&quot;myCanvas&quot; /&gt;</span><br><span class="line">  &lt;/el-row&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure>

<p>在点击员工的图片时，显示弹层，并将图片地址转化成二维码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">showQrCode</span>(<span class="params">url</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// url存在的情况下 才弹出层</span></span><br><span class="line">  <span class="keyword">if</span> (url) &#123;</span><br><span class="line">    <span class="built_in">this</span>.showCodeDialog = <span class="literal">true</span> <span class="comment">// 数据更新了 但是我的弹层会立刻出现吗 ？页面的渲染是异步的！！！！</span></span><br><span class="line">    <span class="comment">// 有一个方法可以在上一次数据更新完毕，页面渲染完毕之后</span></span><br><span class="line">    <span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 此时可以确认已经有ref对象了</span></span><br><span class="line">      QrCode.toCanvas(<span class="built_in">this</span>.$refs.myCanvas, url) <span class="comment">// 将地址转化成二维码</span></span><br><span class="line">      <span class="comment">// 如果转化的二维码后面信息 是一个地址的话 就会跳转到该地址 如果不是地址就会显示内容</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$message.warning(<span class="string">&#x27;该用户还未上传头像&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150011.png" alt="image-20201028180651472"></p>
<h2 id="打印员工信息"><a href="#打印员工信息" class="headerlink" title="打印员工信息"></a>打印员工信息</h2><p><strong><code>目标</code></strong> 完成个人信息和工作信息的打印功能</p>
<h3 id="新建打印页面及路由"><a href="#新建打印页面及路由" class="headerlink" title="新建打印页面及路由"></a>新建打印页面及路由</h3><p><strong>创建页面组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;dashboard-container&quot; id=&quot;myPrint&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;app-container&quot;&gt;</span><br><span class="line">      &lt;el-card&gt;</span><br><span class="line">        &lt;el-breadcrumb separator=&quot;/&quot; class=&quot;titInfo &quot;&gt;</span><br><span class="line">          &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item&gt;</span><br><span class="line">            &lt;router-link :to=&quot;&#123;&#x27;path&#x27;:&#x27;/employees&#x27;&#125;&quot;&gt;员工管理&lt;/router-link&gt;</span><br><span class="line">          &lt;/el-breadcrumb-item&gt;</span><br><span class="line">          &lt;el-breadcrumb-item&gt;打印&lt;/el-breadcrumb-item&gt;</span><br><span class="line">        &lt;/el-breadcrumb&gt;</span><br><span class="line">        &lt;div v-if=&quot;type === &#x27;personal&#x27;&quot;&gt;</span><br><span class="line">          &lt;h2 class=&quot;centInfo&quot;&gt;员工信息表&lt;/h2&gt;</span><br><span class="line">          &lt;table cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;tableList&quot;&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;基本信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th style=&quot;width:10%&quot;&gt;姓名&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot; style=&quot;width:80%&quot;&gt;&#123;&#123; formData.username &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;td rowspan=&quot;5&quot; style=&quot;width:10%&quot;&gt;&lt;img style=&quot;width:155px;height:218px&quot; :src=&quot;formData.staffPhoto&quot;&gt;&lt;/td&gt;</span><br><span class="line"></span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.sex &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;手机&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.mobile &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;出生日期&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.dateOfBirth | formatDate &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;最高学历&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.theHighestDegreeOfEducation &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th style=&quot;width:10%&quot;&gt;是否可编辑&lt;/th&gt;</span><br><span class="line">              &lt;td style=&quot;width:35%&quot;&gt;&#123;&#123; formData.isItEditable &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th style=&quot;width:10%&quot;&gt;是否隐藏号码&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot; style=&quot;width:45%&quot;&gt;&#123;&#123; formData.doYouHideNumbers &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;国家地区&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.nationalArea &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;护照号&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.passportNo &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;身份证号&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.idNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;身份证照片&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.iDCardPhoto &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;籍贯&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.nativePlace &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;民族&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.nation &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;英文名&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.englishName &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;婚姻状况&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.maritalStatus &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;员工照片&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.staffPhoto &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;生日&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.birthday &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;属相&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.zodiac &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.age &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;星座&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.constellation &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;血型&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.bloodType &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;户籍所在地&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.domicile &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;政治面貌&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.politicalOutlook &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;入党时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.timeToJoinTheParty &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;存档机构&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.archivingOrganization &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;子女状态&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.stateOfChildren &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;子女有无商业保险&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.doChildrenHaveCommercialInsurance &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;有无违法违纪行为&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.isThereAnyViolationOfLawOrDiscipline &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;有无重大病史&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.areThereAnyMajorMedicalHistories &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;通讯信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;QQ&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.qQ &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;微信&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.weChat &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;居住证城市&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.residenceCardCity &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;居住证办理日期&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.dateOfResidencePermit &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;居住证截止日期&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.residencePermitDeadline &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;现居住地&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.placeOfResidence &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;通讯地址&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.postalAddress &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;联系手机&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.contactTheMobilePhone &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;个人邮箱&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.personalMailbox &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;紧急联系人&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.emergencyContact &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;紧急联系电话&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;7&quot;&gt;&#123;&#123; formData.emergencyContactNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;账号信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;社保电脑号&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.socialSecurityComputerNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;公积金账号&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.providentFundAccount &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;银行卡号&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.bankCardNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;开户行&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.openingBank &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;教育信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;学历类型&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.educationalType &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;毕业学校&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduateSchool &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;入学时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.enrolmentTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;毕业时间&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduationTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;专业&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.major &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;毕业证书&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduationCertificate &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;学位证书&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;7&quot;&gt;&#123;&#123; formData.certificateOfAcademicDegree &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;从业信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;上家公司&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.homeCompany &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;职称&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.title &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;简历&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.resume &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;有无竞业限制&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.isThereAnyCompetitionRestriction &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;前公司离职证明&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.proofOfDepartureOfFormerCompany &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;备注&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.remarks &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/table&gt;</span><br><span class="line">          &lt;div class=&quot;foot&quot;&gt;签字：___________日期:___________&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div v-else&gt;</span><br><span class="line">          &lt;h2 class=&quot;centInfo&quot;&gt;岗位信息表&lt;/h2&gt;</span><br><span class="line">          &lt;table cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;tableList&quot;&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;基本信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th style=&quot;width:10%&quot;&gt;姓名&lt;/th&gt;</span><br><span class="line">              &lt;td style=&quot;width:40%&quot;&gt;&#123;&#123; formData.username &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th style=&quot;width:10%&quot;&gt;入职日期&lt;/th&gt;</span><br><span class="line">              &lt;td style=&quot;width:40%&quot;&gt;&#123;&#123; formData.dateOfEntry &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;部门&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.departmentName &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;岗位&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.post &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;工作邮箱&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.workMailbox &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;工号&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.workNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;转正日期&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.dateOfCorrection &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;转正状态&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.stateOfCorrection &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;职级&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.rank &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;汇报对象&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.reportName &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;HRBP&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.hRBP &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;聘用形式&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.formOfEmployment &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;管理形式&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.formOfManagement &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;调整司龄&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.adjustmentAgedays &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;司龄&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.ageOfDivision &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;首次参加工作时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.workingTimeForTheFirstTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;调整工龄天&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.adjustmentOfLengthOfService &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;工龄&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.workingYears &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;纳税城市&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.taxableCity &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;转正评价&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.correctionEvaluation &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;合同信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;首次合同开始时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.initialContractStartTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;首次合同结束时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.firstContractTerminationTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;现合同开始时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.currentContractStartTime &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;现合同结束时间&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.closingTimeOfCurrentContract &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;合同期限&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.contractPeriod &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;合同文件&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.contractDocuments &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;续签次数&lt;/th&gt;</span><br><span class="line">              &lt;td colspan=&quot;3&quot;&gt;&#123;&#123; formData.renewalNumber &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;招聘信息&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;其他招聘渠道&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.otherRecruitmentChannels &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;招聘渠道&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.recruitmentChannels &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;社招校招&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.socialRecruitment &#125;&#125;&lt;/td&gt;</span><br><span class="line">              &lt;th&gt;推荐企业人&lt;/th&gt;</span><br><span class="line">              &lt;td&gt;&#123;&#123; formData.recommenderBusinessPeople &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/table&gt;</span><br><span class="line">          &lt;div class=&quot;foot&quot;&gt;签字：___________日期:___________&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/el-card&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; getPersonalDetail, getJobDetail &#125; from &#x27;@/api/employees&#x27;</span><br><span class="line">import &#123; getUserDetailById &#125; from &#x27;@/api/user&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      formData: &#123;&#125;,</span><br><span class="line">      userId: this.$route.params.id,</span><br><span class="line">      type: this.$route.query.type // 打印类型</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  // 创建完毕状态</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.type === &#x27;personal&#x27; ? this.getPersonalDetail() : this.getJobDetail()</span><br><span class="line">  &#125;,</span><br><span class="line">  // 组件更新</span><br><span class="line">  methods: &#123;</span><br><span class="line">    async getPersonalDetail() &#123;</span><br><span class="line">      this.formData = await getPersonalDetail(this.userId) // 获取个人基本信息</span><br><span class="line">    &#125;,</span><br><span class="line">    async getJobDetail() &#123;</span><br><span class="line">      const userInfo = await getUserDetailById(this.userId)</span><br><span class="line">      const jobInfo = await getJobDetail(this.userId) // 获取个人基本信息</span><br><span class="line">      this.formData = &#123; ...userInfo, ...jobInfo &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.foot &#123;</span><br><span class="line">  padding: 30px 0;</span><br><span class="line">  text-align: right;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>该页面内容实际上就是读取个人和详情的接口数据，根据传入的type类型决定显示个人还是岗位</p>
</blockquote>
<p>type为**<code>personal</code><strong>时显示个人，为</strong><code>job</code>**时显示岗位</p>
<p><strong>新建打印页面路由</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;print/:id&#x27;</span>, <span class="comment">// 二级默认路由</span></span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/employees/print&#x27;</span>), <span class="comment">// 按需加载</span></span><br><span class="line">    <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;打印&#x27;</span>, <span class="comment">// 标记当前路由规则的中文名称 后续在做左侧菜单时 使用</span></span><br><span class="line">      <span class="attr">icon</span>: <span class="string">&#x27;people&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>完成详情到打印的跳转</p>
<p><strong>个人</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;</span><br><span class="line">           &lt;el-tooltip content=&quot;打印个人基本信息&quot;&gt;</span><br><span class="line">               &lt;router-link :to=&quot;`/employees/print/$&#123;userId&#125;?type=personal`&quot;&gt;</span><br><span class="line">                 &lt;i class=&quot;el-icon-printer&quot; /&gt;</span><br><span class="line">               &lt;/router-link&gt;</span><br><span class="line">            &lt;/el-tooltip&gt;</span><br><span class="line"> &lt;/el-row&gt;</span><br></pre></td></tr></table></figure>

<p><strong>岗位</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;</span><br><span class="line">            &lt;el-tooltip content=&quot;打印岗位信息&quot;&gt;</span><br><span class="line">              &lt;router-link :to=&quot;`/employees/print/$&#123;userId&#125;?type=job`&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;el-icon-printer&quot;  /&gt;</span><br><span class="line">              &lt;/router-link&gt;</span><br><span class="line">            &lt;/el-tooltip&gt;</span><br><span class="line">  &lt;/el-row&gt;</span><br></pre></td></tr></table></figure>

<h3 id="利用vue-print-nb进行打印"><a href="#利用vue-print-nb进行打印" class="headerlink" title="利用vue-print-nb进行打印"></a>利用vue-print-nb进行打印</h3><p>首先，打印功能我们借助一个比较流行的插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm i vue-print-nb</span><br></pre></td></tr></table></figure>

<blockquote>
<p>它的用法是 </p>
</blockquote>
<p>首先注册该插件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Print <span class="keyword">from</span> <span class="string">&#x27;vue-print-nb&#x27;</span></span><br><span class="line">Vue.use(Print);</span><br></pre></td></tr></table></figure>

<p>使用v-print指令的方式进行打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;</span><br><span class="line">        &lt;el-button v-print=&quot;printObj&quot; size=&quot;small&quot; type=&quot;primary&quot;&gt;打印&lt;/el-button&gt;</span><br><span class="line"> &lt;/el-row&gt;</span><br><span class="line"> printObj: &#123;</span><br><span class="line">      id: &#x27;myPrint&#x27;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>最终，我们看到的效果</p>
<p><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211120150012.png" alt="image-20200728013006535"></p>
<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**打印员工信息</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">满天鑫</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://smanman.github.io/post/30b1ad4a.html">https://smanman.github.io/post/30b1ad4a.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://smanman.github.io" target="_blank">满天鑫</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/tags/sass%E4%B8%AD%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE/">sass中台管理项目</a></div><div class="post_share"><div class="social-share" data-image="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212104.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/mm_facetoface_collect_qrcode_1628169825807.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/LVXUEYANGTiger/blog@main/1628169797.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/2fd5a6f7.html"><img class="prev-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212100.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">权限设计和管理</div></div></a></div><div class="next-post pull-right"><a href="/post/9289abe7.html"><img class="next-cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212104.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">打包上线</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/7e996e60.html" title="JavaScript基础第02天笔记"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082010.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-18</div><div class="title">JavaScript基础第02天笔记</div></div></a></div><div><a href="/post/2e39ac9e.html" title="day04 - Web APIs"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212050.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-18</div><div class="title">day04 - Web APIs</div></div></a></div><div><a href="/post/747c7703.html" title="vuex基础"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211004082041.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-19</div><div class="title">vuex基础</div></div></a></div><div><a href="/post/51ca4a7c.html" title="基础环境搭建"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212025.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-19</div><div class="title">基础环境搭建</div></div></a></div><div><a href="/post/63067f0d.html" title="登录模块"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212120.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-19</div><div class="title">登录模块</div></div></a></div><div><a href="/post/51171306.html" title="主页模块"><img class="cover" src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/20211108212055.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-19</div><div class="title">主页模块</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E6%A0%8F"><span class="toc-number">1.</span> <span class="toc-text">封装一个通用的工具栏</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%B7%A5%E5%85%B7%E6%A0%8F%E7%9A%84%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">通用工具栏的组件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%BB%9F%E4%B8%80%E6%B3%A8%E5%86%8C"><span class="toc-number">1.2.</span> <span class="toc-text">组件统一注册</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%97%E8%A1%A8%E9%A1%B5%E9%9D%A2%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80%E5%92%8C%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">员工列表页面的基本布局和结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E5%92%8C%E5%88%86%E9%A1%B5%E5%8A%A0%E8%BD%BD"><span class="toc-number">3.</span> <span class="toc-text">员工列表数据请求和分页加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%97%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">4.</span> <span class="toc-text">员工列表中的数据进行格式化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%88%97%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B1%9E%E6%80%A7%E5%A4%84%E7%90%86%E8%81%98%E7%94%A8%E5%BD%A2%E5%BC%8F"><span class="toc-number">4.1.</span> <span class="toc-text">利用列格式化属性处理聘用形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E8%A7%A3%E5%86%B3%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">4.2.</span> <span class="toc-text">过滤器解决时间格式的处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%91%98%E5%B7%A5%E5%8A%9F%E8%83%BD"><span class="toc-number">5.</span> <span class="toc-text">删除员工功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%91%98%E5%B7%A5%E5%8A%9F%E8%83%BD-%E5%BC%B9%E5%B1%82-%E6%A0%A1%E9%AA%8C-%E9%83%A8%E9%97%A8"><span class="toc-number">6.</span> <span class="toc-text">新增员工功能-弹层-校验-部门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%91%98%E5%B7%A5%E5%BC%B9%E5%B1%82%E7%BB%84%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">新建员工弹层组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E5%BC%B9%E5%87%BA%E5%B1%82%EF%BC%8C%E7%82%B9%E5%87%BB%E5%BC%B9%E5%87%BA"><span class="toc-number">6.2.</span> <span class="toc-text">引用弹出层，点击弹出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%91%98%E5%B7%A5%E7%9A%84%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="toc-number">6.3.</span> <span class="toc-text">新增员工的表单校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E9%83%A8%E9%97%A8%E6%95%B0%E6%8D%AE%E8%BD%AC%E5%8C%96%E6%A0%91%E5%BD%A2"><span class="toc-number">6.4.</span> <span class="toc-text">加载部门数据转化树形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E9%83%A8%E9%97%A8%E8%B5%8B%E5%80%BC%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE"><span class="toc-number">6.5.</span> <span class="toc-text">点击部门赋值表单数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%91%98%E5%B7%A5%E5%8A%9F%E8%83%BD-%E7%A1%AE%E5%AE%9A-%E5%8F%96%E6%B6%88"><span class="toc-number">7.</span> <span class="toc-text">新增员工功能-确定-取消</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%AF%BC%E5%85%A5%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85"><span class="toc-number">8.</span> <span class="toc-text">员工导入组件封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">9.</span> <span class="toc-text">员工的导入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E5%85%AC%E5%85%B1%E5%AF%BC%E5%85%A5%E7%9A%84%E9%A1%B5%E9%9D%A2%E8%B7%AF%E7%94%B1"><span class="toc-number">9.1.</span> <span class="toc-text">建立公共导入的页面路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90excel%E5%AF%BC%E5%85%A5%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%B0%81%E8%A3%85%E6%8E%A5%E5%8F%A3"><span class="toc-number">9.2.</span> <span class="toc-text">分析excel导入代码，封装接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0excel%E5%AF%BC%E5%85%A5"><span class="toc-number">9.3.</span> <span class="toc-text">实现excel导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%AF%BC%E5%87%BAexcel%E5%8A%9F%E8%83%BD"><span class="toc-number">10.</span> <span class="toc-text">员工导出excel功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85excel%E6%89%80%E9%9C%80%E4%BE%9D%E8%B5%96%E5%92%8C%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD"><span class="toc-number">10.1.</span> <span class="toc-text">安装excel所需依赖和按需加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#excel%E5%AF%BC%E5%87%BA%E5%8F%82%E6%95%B0%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">10.2.</span> <span class="toc-text">excel导出参数的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#excel%E5%AF%BC%E5%87%BA%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">10.3.</span> <span class="toc-text">excel导出基本的结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">10.4.</span> <span class="toc-text">导出时间格式的处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95-%E5%A4%8D%E6%9D%82%E8%A1%A8%E5%A4%B4%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-number">10.5.</span> <span class="toc-text">扩展  复杂表头的导出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E8%AF%A6%E6%83%85%E9%A1%B5%E5%88%9B%E5%BB%BA%E5%92%8C%E5%B8%83%E5%B1%80"><span class="toc-number">11.</span> <span class="toc-text">员工详情页创建和布局</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%A6%E6%83%85%E9%A1%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80%E5%92%8C%E8%B7%AF%E7%94%B1"><span class="toc-number">11.1.</span> <span class="toc-text">详情页的基本布局和路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%92%8C%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%9A%84%E6%8E%A5%E5%8F%A3"><span class="toc-number">11.2.</span> <span class="toc-text">读取和保存用户信息的接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">11.3.</span> <span class="toc-text">实现用户名和密码的修改</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E7%BB%84%E4%BB%B6%E5%92%8C%E5%B2%97%E4%BD%8D%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85"><span class="toc-number">12.</span> <span class="toc-text">个人组件和岗位组件封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%AA%E4%BA%BA%E8%AF%A6%E6%83%85%E7%BB%84%E4%BB%B6"><span class="toc-number">12.1.</span> <span class="toc-text">封装个人详情组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E5%B2%97%E4%BD%8D%E7%BB%84%E4%BB%B6"><span class="toc-number">12.2.</span> <span class="toc-text">封装岗位组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E5%92%8C%E5%B2%97%E4%BD%8D%E4%BF%A1%E6%81%AF-%E8%AF%BB%E5%8F%96-%E4%BF%9D%E5%AD%98"><span class="toc-number">13.</span> <span class="toc-text">员工个人信息和岗位信息-读取-保存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E4%B8%AA%E4%BA%BA%E4%BF%9D%E5%AD%98%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF"><span class="toc-number">13.1.</span> <span class="toc-text">读取个人保存个人信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E4%BF%9D%E5%AD%98%E5%B2%97%E4%BD%8D%E4%BF%A1%E6%81%AF"><span class="toc-number">13.2.</span> <span class="toc-text">读取保存岗位信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%85%BE%E8%AE%AF%E4%BA%91Cos"><span class="toc-number">14.</span> <span class="toc-text">配置腾讯云Cos</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E7%BB%84%E4%BB%B6-%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">15.</span> <span class="toc-text">封装上传图片组件-上传组件需求分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">16.</span> <span class="toc-text">封装上传组件-代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6"><span class="toc-number">16.1.</span> <span class="toc-text">新建文件上传组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E9%A2%84%E8%A7%88"><span class="toc-number">16.2.</span> <span class="toc-text">点击图片进行预览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E4%B8%8A%E4%BC%A0%E6%95%B0%E9%87%8F%E6%8E%A7%E5%88%B6%E4%B8%8A%E4%BC%A0%E6%8C%89%E9%92%AE"><span class="toc-number">16.3.</span> <span class="toc-text">根据上传数量控制上传按钮</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%9B%BE%E7%89%87%E5%92%8C%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87"><span class="toc-number">16.4.</span> <span class="toc-text">删除图片和添加图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E4%B9%8B%E5%89%8D%E6%A3%80%E6%9F%A5"><span class="toc-number">16.5.</span> <span class="toc-text">上传之前检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E5%8A%A8%E4%BD%9C%E8%B0%83%E7%94%A8%E4%B8%8A%E4%BC%A0%E8%85%BE%E8%AE%AF%E4%BA%91"><span class="toc-number">16.6.</span> <span class="toc-text">上传动作调用上传腾讯云</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%E4%B9%8B%E5%90%8E%E5%A4%84%E7%90%86%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE"><span class="toc-number">16.7.</span> <span class="toc-text">上传成功之后处理返回数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E7%9A%84%E8%BF%9B%E5%BA%A6%E6%9D%A1%E6%98%BE%E7%A4%BA"><span class="toc-number">16.8.</span> <span class="toc-text">上传的进度条显示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E5%91%98%E5%B7%A5%E8%AF%A6%E6%83%85%E4%B8%AD%E5%BA%94%E7%94%A8%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6"><span class="toc-number">17.</span> <span class="toc-text">在员工详情中应用上传组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%91%98%E5%B7%A5%E7%9A%84%E5%A4%B4%E5%83%8F%E5%92%8C%E8%AF%81%E4%BB%B6%E7%85%A7%E8%B5%8B%E5%80%BC%E7%BB%99%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6"><span class="toc-number">17.1.</span> <span class="toc-text">将员工的头像和证件照赋值给上传组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E6%97%B6%E5%A4%84%E7%90%86%E5%A4%B4%E5%83%8F%E5%92%8C%E8%AF%81%E4%BB%B6%E7%85%A7%E7%9A%84%E4%BF%9D%E5%AD%98"><span class="toc-number">17.2.</span> <span class="toc-text">保存时处理头像和证件照的保存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%97%E8%A1%A8%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><span class="toc-number">18.</span> <span class="toc-text">员工列表显示图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">19.</span> <span class="toc-text">图片地址生成二维码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF"><span class="toc-number">20.</span> <span class="toc-text">打印员工信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E6%89%93%E5%8D%B0%E9%A1%B5%E9%9D%A2%E5%8F%8A%E8%B7%AF%E7%94%B1"><span class="toc-number">20.1.</span> <span class="toc-text">新建打印页面及路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8vue-print-nb%E8%BF%9B%E8%A1%8C%E6%89%93%E5%8D%B0"><span class="toc-number">20.2.</span> <span class="toc-text">利用vue-print-nb进行打印</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 满天鑫</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><img src="https://note-1259153703.cos.ap-nanjing.myqcloud.com/images/202301132049386.png"/><span> </span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">晋ICP备2022012091号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'pinglun-9gh2lmcnd8587831',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'pinglun-9gh2lmcnd8587831',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script src="//code.tidio.co/smwivpnwumemac2wohardi3d3gpud1ag.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>